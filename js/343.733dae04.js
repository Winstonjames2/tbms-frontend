"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[343],{343:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var o=a(1758);function n(e,t,a,n,l,s){const c=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.CE)(o.FK,null,[t[0]||(t[0]=(0,o.Lk)("div",{class:"map-container"},[(0,o.Lk)("div",{id:"map",style:{width:"100%"}})],-1)),(0,o.bF)(c,{label:e.$t("trackvehicle.fullmap.togglemapview"),onClick:n.toggleMapStyle,color:"primary",class:"q-mt-md",unelevated:"",icon:"sym_r_map","icon-right":"sym_r_swap_horiz"},null,8,["label","onClick"])],64)}var l=a(1083),s=a.n(l),c=a(555),r=a(3537);const i={name:"PageFullMap",props:{deviceData:{type:Array,required:!0}},setup(e){const t=(0,r.s9)(),a=(0,c.KR)(null),n=(0,c.KR)([96.1,16.93]),l=async()=>{try{for(const t of e.deviceData)i(t)}catch(e){console.error("Error fetching track data:",e)}},i=e=>{const t=[e.longitude,e.latitude],o=e.direction,n={type:"Feature",geometry:{type:"Point",coordinates:t}};a.value.addSource(`truck-${t.join("-")}`,{type:"geojson",data:{type:"FeatureCollection",features:[n]}}),a.value.addLayer({id:`truck-${t.join("-")}`,type:"symbol",source:`truck-${t.join("-")}`,layout:{"icon-image":`${e.status}-truck-icon`,"icon-size":.1,"icon-allow-overlap":!0,"icon-rotate":(parseInt(o,10)+360)%360}})},u=(e,t)=>new Promise(((a,o)=>{e.loadImage(t,((e,t)=>{e&&o(e),a(t)}))})),p=()=>{const e=a.value.getStyle().sprite.split("/").pop(),t="streets-v12"===e?"satellite-v9":"streets-v12";a.value.setStyle(`mapbox://styles/mapbox/${t}`),a.value.once("styledata",d)},d=async()=>{const e=[{name:"Idling-truck-icon",url:"/statics/baseinfo/idling-truck.png"},{name:"Offline-truck-icon",url:"/statics/baseinfo/offline-truck.png"},{name:"Moving-truck-icon",url:"/statics/baseinfo/moving-truck.png"},{name:"Stopped-truck-icon",url:"/statics/baseinfo/stopped-truck.png"}];for(const t of e)a.value.addImage(t.name,await u(a.value,t.url));l()};return(0,o.sV)((()=>{const e="pk.eyJ1Ijoid2luc3RvbjNvIiwiYSI6ImNtM282eHl4MTAwY3Aya3NkeGwxaWhsemgifQ.FM7yc1gc2BdH0t9IBTk7bg";s().accessToken=e,a.value=new(s().Map)({container:"map",style:"mapbox://styles/mapbox/streets-v12",center:n.value,zoom:7,attributionControl:!1}),a.value.on("load",d)})),{t,map:a,toggleMapStyle:p}}};var u=a(2807),p=a(6384),d=a(8582),m=a.n(d);const g=(0,u.A)(i,[["render",n],["__scopeId","data-v-3d9d2380"]]),v=g;m()(i,"components",{QBtn:p.A})}}]);