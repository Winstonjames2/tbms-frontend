"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[852],{3852:(e,t,a)=>{a.r(t),a.d(t,{default:()=>H});a(310),a(5962);var l=a(1758),o=a(6683),n=a(2901);const i={class:"q-mt-md"},s={class:"bottom-footer"},d={class:"footer-item"},r={class:"footer-item"},c={class:"footer-item"},u={class:"q-pa-sm flex flex-center",style:{gap:"12px"}},p={class:"q-pa-sm flex flex-center"},g={class:"text-h6"},m={class:"text-subtitle2"},_={style:{"font-weight":"bold"}},h={style:{"font-weight":"bold"}},b={style:{"font-weight":"bold"}},v={class:"text-bold"},f={class:"text-bold"};function y(e,t,a,y,k,w){const x=(0,l.g2)("q-tooltip"),F=(0,l.g2)("q-btn"),W=(0,l.g2)("q-btn-group"),A=(0,l.g2)("q-space"),C=(0,l.g2)("q-icon"),S=(0,l.g2)("q-input"),N=(0,l.g2)("q-checkbox"),L=(0,l.g2)("q-td"),q=(0,l.g2)("q-tr"),z=(0,l.g2)("q-table"),K=(0,l.g2)("q-pagination"),Q=(0,l.g2)("q-card-section"),E=(0,l.g2)("q-separator"),D=(0,l.g2)("q-card-actions"),T=(0,l.g2)("q-card"),V=(0,l.g2)("q-dialog"),R=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(o.eB,{appear:"","enter-active-class":"animated fadeIn"},{default:(0,l.k6)((()=>[(0,l.bF)(z,{separator:"cell",class:"my-sticky-header-column-table shadow-24",rows:y.tableList,"row-key":"id",loading:y.loading,filter:null,columns:y.columns,flat:"",bordered:"",selection:"multiple",selected:y.selected,"onUpdate:selected":t[1]||(t[1]=e=>y.selected=e),"no-data-label":"No data","no-results-label":"No data you want","rows-per-page-options":[0],style:{height:"calc(100vh - 190px)"}},{top:(0,l.k6)((()=>[(0,l.bF)(W,{push:""},{default:(0,l.k6)((()=>[(0,l.bF)(F,{label:e.$t("refresh"),icon:"sym_r_refresh",onClick:y.handleRefresh},{default:(0,l.k6)((()=>[(0,l.bF)(x,(0,n._B)((0,l.Ng)(y.tooltip)),{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(y.t("refreshtip")),1)])),_:1},16)])),_:1},8,["label","onClick"])])),_:1}),(0,l.bF)(A),(0,l.bF)(S,{outlined:"",rounded:"",dense:"",debounce:"600",color:"primary",modelValue:y.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>y.filter=e),placeholder:e.$t("search"),style:{"max-width":"220px",width:"30%"},clearable:"",onClear:y.clearFilter},{append:(0,l.k6)((()=>[(0,l.bF)(C,{name:"sym_r_search"})])),_:1},8,["modelValue","placeholder","onClear"])])),body:(0,l.k6)((e=>[(0,l.bF)(q,{props:e},{default:(0,l.k6)((()=>[(0,l.bF)(L,{key:"checkbox",style:{width:"48px","text-align":"center"}},{default:(0,l.k6)((()=>[(0,l.bF)(N,{"model-value":y.isRowSelected(e.row),"onUpdate:modelValue":t=>y.onSelection(t,e.row),dense:"","aria-label":"select-row"},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(L,{key:"code",props:e},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.row.code),1)])),_:2},1032,["props"]),(0,l.bF)(L,{key:"received_date",props:e},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.row.received_date),1)])),_:2},1032,["props"]),(0,l.bF)(L,{key:"customer",props:e},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.row.customer),1)])),_:2},1032,["props"]),(0,l.bF)(L,{key:"company",props:e},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.row.company),1)])),_:2},1032,["props"]),(0,l.bF)(L,{key:"total_weight",props:e},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.row.total_weight+" "+y.t("vs")),1)])),_:2},1032,["props"]),(0,l.bF)(L,{key:"total_amount",props:e},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(y.formatNumber(e.row.total_amount)+" "+y.t("ks")),1)])),_:2},1032,["props"]),(0,l.bF)(L,{key:"action",props:e,style:{width:"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(F,{round:"",flat:"",push:"",color:"amber-2",icon:"sym_r_visibility",onClick:t=>y.viewDetail(e.row.id),dense:""},{default:(0,l.k6)((()=>[(0,l.bF)(x,(0,n._B)((0,l.Ng)(y.tooltip)),{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(y.t("viewdetail")),1)])),_:1},16)])),_:2},1032,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),bottom:(0,l.k6)((()=>[(0,l.Lk)("div",s,[(0,l.Lk)("div",d,[(0,l.eW)((0,n.v_)(y.t("dispatch_planning.selected"))+": ",1),(0,l.Lk)("span",null,(0,n.v_)(y.selectedQuantity),1)]),(0,l.Lk)("div",r,[(0,l.eW)((0,n.v_)(y.t("dispatch_planning.totalWeight"))+": ",1),(0,l.Lk)("span",null,(0,n.v_)(y.grandTotalWeight+" "+y.t("vs")),1)]),(0,l.Lk)("div",c,[(0,l.eW)((0,n.v_)(y.t("dispatch_planning.total"))+": ",1),(0,l.Lk)("span",null,(0,n.v_)(y.formatNumber(y.grandTotalAmount)+" "+y.t("ks")),1)]),(0,l.bF)(F,{label:e.$t("dispatch_planning.forward"),icon:"sym_r_forward","no-caps":"",color:"primary",onClick:y.SubmitData,push:""},{default:(0,l.k6)((()=>[(0,l.bF)(x,(0,n._B)((0,l.Ng)(y.tooltip)),{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(y.t("dispatch_planning.forwardtip")),1)])),_:1},16)])),_:1},8,["label","onClick"])])])),_:1},8,["rows","loading","columns","selected"])])),_:1}),(0,l.bo)((0,l.Lk)("div",u,[(0,l.bF)(K,{modelValue:y.current,"onUpdate:modelValue":[t[2]||(t[2]=e=>y.current=e),y.handlePaginationChange],max:y.maxPages,"max-pages":10,"boundary-links":"",color:"red-8"},null,8,["modelValue","max","onUpdate:modelValue"]),(0,l.bF)(S,{modelValue:y.paginationIpt,"onUpdate:modelValue":t[3]||(t[3]=e=>y.paginationIpt=e),modelModifiers:{number:!0},outlined:"",round:"",dense:"",color:"red-8",onBlur:y.changePageEnter,onKeyup:(0,o.jR)(y.changePageEnter,["enter"]),style:{width:"50px"},class:"center"},null,8,["modelValue","onBlur","onKeyup"])],512),[[o.aG,y.maxPages>0]]),(0,l.bo)((0,l.Lk)("div",p,[(0,l.bF)(F,{flat:"",push:"",color:"darkText",label:e.$t("no_data")},null,8,["label"])],512),[[o.aG,0===y.maxPages]]),(0,l.bF)(V,{modelValue:y.detailDialog,"onUpdate:modelValue":t[4]||(t[4]=e=>y.detailDialog=e),persistent:"","full-width":"",class:"custom-scrollbar-color"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{style:{"max-width":"900px",margin:"auto 10vw"}},{default:(0,l.k6)((()=>[(0,l.bF)(Q,{class:"bg-primary text-white"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",g,[(0,l.eW)((0,n.v_)(y.t("dispatch_planning.consignment_detail"))+" #"+(0,n.v_)(y.consignmentDetail?.code)+" ",1),(0,l.bo)((0,l.bF)(F,{round:"",dense:"",flat:"",icon:"sym_r_close",class:"float-right"},null,512),[[R]])]),(0,l.Lk)("div",m,[(0,l.eW)((0,n.v_)(y.t("dispatch_planning.inventory_list.customer"))+": ",1),(0,l.Lk)("span",_,(0,n.v_)(y.consignmentDetail?.customer),1),(0,l.eW)(" | "+(0,n.v_)(y.t("dispatch_planning.inventory_list.company"))+": ",1),(0,l.Lk)("span",h,(0,n.v_)(y.consignmentDetail?.company),1),(0,l.eW)(" | "+(0,n.v_)(y.t("dispatch_planning.inventory_list.received_date"))+": ",1),(0,l.Lk)("span",b,(0,n.v_)(y.consignmentDetail?.received_date),1)])])),_:1}),(0,l.bF)(E),(0,l.bF)(Q,null,{default:(0,l.k6)((()=>[(0,l.bF)(z,{rows:y.goodsList,columns:y.goodsColumns,"row-key":"id",flat:"",bordered:"","hide-bottom":"","no-data-label":"No data","no-results-label":"No data you want",separator:"cell","rows-per-page-options":[0]},{body:(0,l.k6)((e=>[(0,l.bF)(q,{props:e},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.goodsColumns,(t=>((0,l.uX)(),(0,l.Wv)(L,{key:t.name,props:e},{default:(0,l.k6)((()=>["total_weight"===t.name?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.eW)((0,n.v_)(e.row.total_weight+" "+y.t("vs")),1)],64)):"total_amount"===t.name?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)((0,n.v_)(y.formatNumber(e.row.total_amount)+" "+y.t("ks")),1)],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[(0,l.eW)((0,n.v_)(e.row[t.field]),1)],64))])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns"])])),_:1}),(0,l.bF)(Q,{class:"row justify-end q-gutter-sm"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",v,(0,n.v_)(y.t("dispatch_planning.check_list.grandTotalWeight"))+": "+(0,n.v_)(y.goodsTotals.totalWeight)+" "+(0,n.v_)(y.t("viss")),1),(0,l.bF)(E,{vertical:"",color:"primary"}),(0,l.Lk)("div",f,(0,n.v_)(y.t("dispatch_planning.check_list.grandTotalAmount"))+": "+(0,n.v_)(y.formatNumber(y.goodsTotals.totalAmount))+" "+(0,n.v_)(y.t("kyats")),1)])),_:1}),(0,l.bF)(D,{align:"right"},{default:(0,l.k6)((()=>[(0,l.bo)((0,l.bF)(F,{flat:"",label:"Close",color:"primary"},null,512),[[R]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}a(2203),a(2802),a(9240);var k=a(555),w=a(1271),x=a(4907),F=a(3537),W=a(2261),A=a(455);const C="consignment_unloaded_cache_v1",S="selectedPG_unloaded_v1",N={setup(){const e=(0,x.A)(),{t}=(0,F.s9)(),a=(0,A.rd)(),o=(0,k.KR)(!1),n=(0,k.KR)(null),i=(0,k.KR)([]),s=[{name:"goods_code",label:t("dispatch_planning.check_list.goods_code"),field:"goods_code",align:"center",headerStyle:"font-weight: bold; font-size: 13px"},{name:"goods_name",label:t("dispatch_planning.check_list.goods_name"),field:"goods_name",align:"left",headerStyle:"font-weight: bold; font-size: 13px"},{name:"goods_rate",label:t("dispatch_planning.check_list.goods_rate"),field:"goods_rate",align:"right",headerStyle:"font-weight: bold; font-size: 13px"},{name:"remaining_quantity",label:t("dispatch_planning.check_list.quantity"),field:"remaining_quantity",align:"right",headerStyle:"font-weight: bold; font-size: 13px; background-color: rgba(218, 218, 255, 0.238)",style:"background-color: rgba(218, 218, 255, 0.238)"},{name:"total_weight",label:t("dispatch_planning.check_list.total_weight"),field:"total_weight",align:"right",headerStyle:"font-weight: bold; font-size: 13px"},{name:"total_amount",label:t("dispatch_planning.check_list.total_amount"),field:"total_amount",align:"right",headerStyle:"font-weight: bold; font-size: 13px"}],d=(0,k.Kh)({class:"bg-blue text-white shadow-4",offset:[10,10],contentStyle:"font-size: 12px"}),r="consignment/unloaded",c=(0,k.KR)(!1),u=(0,k.KR)([]),p=(0,k.KR)(""),g=(0,k.KR)(25),m=(0,k.KR)(1),_=(0,k.KR)(1),h=(0,k.KR)([]),b=(0,k.Kh)([{name:"code",label:t("dispatch_planning.inventory_list.code"),field:"code",align:"center",sortable:!0,headerStyle:"font-weight: bold; font-size: 13px; z-index: 999"},{name:"received_date",label:t("dispatch_planning.inventory_list.received_date"),field:"received_date",align:"center",headerStyle:"font-weight: bold; font-size: 13px; z-index: 999",sortable:!0},{name:"customer",label:t("dispatch_planning.inventory_list.customer"),field:"customer",align:"left",headerStyle:"font-weight: bold; font-size: 13px; z-index: 999",sortable:!0},{name:"company",label:t("dispatch_planning.inventory_list.company"),field:"company",align:"left",headerStyle:"font-weight: bold; font-size: 13px; z-index: 999",sortable:!0},{name:"total_weight",label:t("dispatch_planning.inventory_list.total_weight"),field:"total_weight",align:"left",headerStyle:"font-weight: bold; font-size: 13px; z-index: 999",sortable:!0},{name:"total_amount",label:t("dispatch_planning.inventory_list.total_amount"),field:"total_amount",align:"left",headerStyle:"font-weight: bold; font-size: 13px; z-index: 999",sortable:!0},{name:"action",label:t("action"),align:"center",headerStyle:"font-weight: bold; font-size: 13px; z-index: 999"}]),v=()=>{try{const e=w.A.getItem(C);return e?"string"===typeof e?JSON.parse(e):e:null}catch(e){return console.warn("Cache read failed",e),null}},f=e=>{w.A.set(C,{ts:Date.now(),data:e})},y=()=>{w.A.remove(C)};try{const e=w.A.getItem(S);e&&(h.value="string"===typeof e?JSON.parse(e):e)}catch(e){console.warn("Failed reading selected cache",e)}(0,l.wB)(h,(e=>{w.A.set(S,e)}),{deep:!0});const N=e=>{const t=Number(e??0);return Number.isFinite(t)?t:0},L=async(a=!1)=>{const l=v();if(console.log(l),l&&l.data&&!a)return u.value=l.data,m.value=1,void(_.value=1);c.value=!0;try{const e=await(0,W.getauth)(`${r}/`);u.value=e.data,f(u.value),m.value=1,_.value=1}catch(a){console.error("fetchAll error",a),e.notify({message:t("error.fetch"),icon:"sym_r_close",color:"negative"})}finally{c.value=!1}},q=()=>{y(),h.value=[],L(!0)},z=(0,l.EW)((()=>p.value?String(p.value).trim().toLowerCase():"")),K=(0,l.EW)((()=>{const e=z.value;return e?u.value.filter((t=>String(t.code??"").toLowerCase().includes(e)||String(t.customer??"").toLowerCase().includes(e)||String(t.company??"").toLowerCase().includes(e))):u.value})),Q=(0,l.EW)((()=>K.value.length)),E=(0,l.EW)((()=>Q.value?Math.ceil(Q.value/g.value):0)),D=(0,l.EW)((()=>{const e=Number(m.value)||1,t=Number(g.value)||25,a=(e-1)*t;return K.value.slice(a,a+t)})),T=()=>{p.value=""},V=e=>{const t=Number(e)||1;m.value=Math.min(Math.max(t,1),E.value||1),_.value=m.value},R=()=>{let e=Number(_.value)||1;e<1&&(e=1),E.value>0&&e>E.value&&(e=E.value),m.value=e},P=e=>h.value.some((t=>t.id===e.id)),I=(e,t)=>{if(e)h.value.some((e=>e.id===t.id))||h.value.push(t);else{const e=h.value.findIndex((e=>e.id===t.id));-1!==e&&h.value.splice(e,1)}},B=()=>{const e=D.value.filter((e=>!h.value.some((t=>t.id===e.id))));h.value.push(...e)},U=()=>{h.value=[]},X=(0,l.EW)((()=>h.value.length)),G=(0,l.EW)((()=>h.value.reduce(((e,t)=>e+N(t.total_amount)),0))),$=(0,l.EW)((()=>h.value.reduce(((e,t)=>e+N(t.total_weight)),0))),M=async a=>{try{e.loading.show(),i.value=u.value.find((e=>e.id===a))&&u.value.find((e=>e.id===a)).receive_goods_items||[],console.log(i.value),n.value=u.value.find((e=>e.id===a))||null,o.value=!0}catch(a){console.error("viewDetail error",a),e.notify({type:"negative",message:t("error.fetch")||"Failed to load detail"})}finally{e.loading.hide()}},j=(0,l.EW)((()=>i.value.reduce(((e,t)=>(e.totalAmount+=Number(t.total_amount||0),e.totalWeight+=Number(t.total_weight||0),e)),{totalAmount:0,totalWeight:0}))),J=e=>(new Intl.NumberFormat).format(Number(e||0)),O=()=>{e.loading.show(),w.A.set("SelectedUnloadedGoods",h.value),e.loading.hide(),a.push({name:"CheckDispatchPlanningList"})};return(0,l.sV)((()=>L(!1))),{t,q:e,tooltip:d,goodsTotals:j,detailDialog:o,consignmentDetail:n,goodsList:i,goodsColumns:s,tableList:D,loading:c,filter:p,columns:b,selected:h,selectedQuantity:X,grandTotalAmount:G,grandTotalWeight:$,current:m,perPage:g,maxPages:E,totalItems:Q,paginationIpt:_,fetchAll:L,handleRefresh:q,viewDetail:M,onSelection:I,selectAll:B,unselect:U,isRowSelected:P,SubmitData:O,handlePaginationChange:V,changePageEnter:R,formatNumber:J,clearFilter:T,toNum:N}}};var L=a(2807),q=a(6653),z=a(6031),K=a(6384),Q=a(7410),E=a(3676),D=a(9270),T=a(492),V=a(4488),R=a(5262),P=a(460),I=a(4700),B=a(2156),U=a(3316),X=a(4189),G=a(386),$=a(2669),M=a(8672),j=a(8582),J=a.n(j);const O=(0,L.A)(N,[["render",y],["__scopeId","data-v-7e4b7b34"]]),H=O;J()(N,"components",{QTable:q.A,QBtnGroup:z.A,QBtn:K.A,QTooltip:Q.A,QSpace:E.A,QInput:D.A,QIcon:T.A,QTr:V.A,QTd:R.A,QCheckbox:P.A,QPagination:I.A,QDialog:B.A,QCard:U.A,QCardSection:X.A,QSeparator:G.A,QCardActions:$.A}),J()(N,"directives",{ClosePopup:M.A})}}]);