"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[589],{5572:(e,a,l)=>{l.r(a),l.d(a,{default:()=>P});l(310),l(5962);var t=l(1758),o=l(6683),n=l(2901);const i={class:"q-mt-md"},r={class:"q-pa-sm flex flex-center"},d={class:"q-pa-sm flex flex-center"};function s(e,a,l,s,c,m){const p=(0,t.g2)("q-tooltip"),u=(0,t.g2)("q-btn"),b=(0,t.g2)("q-btn-group"),y=(0,t.g2)("q-space"),_=(0,t.g2)("q-icon"),h=(0,t.g2)("q-input"),g=(0,t.g2)("q-td"),v=(0,t.g2)("EditableCell"),w=(0,t.g2)("q-tr"),f=(0,t.g2)("q-table"),k=(0,t.g2)("q-pagination"),F=(0,t.g2)("q-bar"),V=(0,t.g2)("q-select"),x=(0,t.g2)("q-card-section"),A=(0,t.g2)("q-card-actions"),C=(0,t.g2)("q-card"),D=(0,t.g2)("q-dialog"),q=(0,t.g2)("view-dialog"),K=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.bF)(o.eB,{appear:"","enter-active-class":"animated fadeIn"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{separator:"cell",class:"my-sticky-header-column-table shadow-24",rows:s.paginatedRows,"row-key":"id",loading:s.loading,filter:s.filter,columns:s.columns,"hide-bottom":"",pagination:s.pagination,"onUpdate:pagination":a[6]||(a[6]=e=>s.pagination=e),paginationModifiers:{sync:!0},"no-data-label":"No data","no-results-label":"No data you want",style:{height:"calc(100vh - 190px)"},flat:"",bordered:""},{top:(0,t.k6)((()=>[(0,t.bF)(b,{push:""},{default:(0,t.k6)((()=>[(0,t.bF)(u,{label:e.$t("new"),icon:"sym_r_add",onClick:a[0]||(a[0]=e=>s.newForm=!0)},{default:(0,t.k6)((()=>[(0,t.bF)(p,(0,n._B)((0,t.Ng)(s.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("newtip")),1)])),_:1},16)])),_:1},8,["label"]),(0,t.bF)(u,{label:e.$t("refresh"),icon:"sym_r_refresh",onClick:a[1]||(a[1]=e=>s.fetchTableData())},{default:(0,t.k6)((()=>[(0,t.bF)(p,(0,n._B)((0,t.Ng)(s.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("refreshtip")),1)])),_:1},16)])),_:1},8,["label"])])),_:1}),(0,t.bF)(y),(0,t.bF)(h,{outlined:"",rounded:"",dense:"",debounce:"300",color:"primary",modelValue:s.filter,"onUpdate:modelValue":a[3]||(a[3]=e=>s.filter=e),placeholder:e.$t("search"),onInput:a[4]||(a[4]=e=>s.getSearchList()),onKeyup:a[5]||(a[5]=(0,o.jR)((e=>s.getSearchList()),["enter"]))},{append:(0,t.k6)((()=>[(0,t.bF)(_,{name:"sym_r_search",onClick:a[2]||(a[2]=e=>s.getSearchList())})])),_:1},8,["modelValue","placeholder"])])),body:(0,t.k6)((e=>[(0,t.bF)(w,{props:e},{default:(0,t.k6)((()=>[(0,t.bF)(g,{key:"code",props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.row.code),1)])),_:2},1032,["props"]),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.editableColumns,(a=>((0,t.uX)(),(0,t.Wv)(v,{key:a.field,row:e.row,field:a.field,label:a.label,rules:a.rules,mask:a.mask,"edit-id":s.editId,"model-value":e.row.id===s.editId?s.editFormData[a.field]:e.row[a.field],translate:a.translate||!1,options:a.options||[],"onUpdate:modelValue":e=>s.editFormData[a.field]=e,props:e},null,8,["row","field","label","rules","mask","edit-id","model-value","translate","options","onUpdate:modelValue","props"])))),128)),(0,t.bF)(g,{key:"creator",props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.row.creator),1)])),_:2},1032,["props"]),(0,t.bF)(g,{key:"create_time",props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.row.create_time),1)])),_:2},1032,["props"]),(0,t.bF)(g,{key:"action",props:e,style:(0,n.Tr)([{width:"100px"},s.actionCellStyle(e)])},{default:(0,t.k6)((()=>[e.row.id!==s.editId?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:0},(0,t.pI)(s.rowActions,(a=>((0,t.uX)(),(0,t.Wv)(u,(0,t.v6)({key:a.icon,ref_for:!0},a,{onClick:l=>a.action(e.row)}),{default:(0,t.k6)((()=>[(0,t.bF)(p,(0,t.v6)({ref_for:!0},s.tooltip),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(a.tip),1)])),_:2},1040)])),_:2},1040,["onClick"])))),128)):((0,t.uX)(!0),(0,t.CE)(t.FK,{key:1},(0,t.pI)(s.editActions,(e=>((0,t.uX)(),(0,t.Wv)(u,(0,t.v6)({key:e.icon,ref_for:!0},e,{onClick:e.action}),null,16,["onClick"])))),128))])),_:2},1032,["props","style"])])),_:2},1032,["props"])])),_:1},8,["rows","loading","filter","columns","pagination"])])),_:1}),(0,t.bo)((0,t.Lk)("div",r,[(0,t.bF)(k,{modelValue:s.current,"onUpdate:modelValue":[a[7]||(a[7]=e=>s.current=e),a[8]||(a[8]=e=>s.paginationIpt=e)],max:s.max,"max-pages":10,"boundary-links":"",color:"red-8"},null,8,["modelValue","max"]),(0,t.bF)(h,{modelValue:s.paginationIpt,"onUpdate:modelValue":a[9]||(a[9]=e=>s.paginationIpt=e),modelModifiers:{number:!0},outlined:"",round:"",dense:"",color:"red-8",onBlur:s.changePageEnter,onKeyup:(0,o.jR)(s.changePageEnter,["enter"]),style:{width:"50px"},class:"center"},null,8,["modelValue","onBlur","onKeyup"])],512),[[o.aG,s.max]]),(0,t.bo)((0,t.Lk)("div",d,[(0,t.bF)(u,{flat:"",push:"",color:"darkText",label:e.$t("no_data")},null,8,["label"])],512),[[o.aG,!s.max]]),(0,t.bF)(D,{modelValue:s.newForm,"onUpdate:modelValue":a[16]||(a[16]=e=>s.newForm=e),"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,t.k6)((()=>[(0,t.bF)(C,{class:"shadow-24 column no-wrap",style:{"max-height":"90vh","max-width":"400px",width:"90vw"}},{default:(0,t.k6)((()=>[(0,t.bF)(F,{class:"bg-primary text-white",style:{"min-height":"50px"}},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(s.t("company.view_company.create_company"))+" ",1),(0,t.bF)(y),(0,t.bo)((0,t.bF)(u,{dense:"",flat:"",icon:"sym_r_close"},null,512),[[K]])])),_:1}),(0,t.bF)(x,{class:"scroll custom-scrollbar-color",style:{"overflow-y":"auto",flex:"1"}},{default:(0,t.k6)((()=>[(0,t.bF)(h,{dense:"",outlined:"",modelValue:s.newFormData.name,"onUpdate:modelValue":a[10]||(a[10]=e=>s.newFormData.name=e),label:e.$t("company.view_company.name"),rules:[s.validate.required],maxlength:"255"},null,8,["modelValue","label","rules"]),(0,t.bF)(V,{dense:"",outlined:"",modelValue:s.newFormData.company_type,"onUpdate:modelValue":a[11]||(a[11]=e=>s.newFormData.company_type=e),options:s.companyTypeOpt,label:e.$t("company.view_company.company_type"),rules:[s.validate.required]},null,8,["modelValue","options","label","rules"]),(0,t.bF)(h,{dense:"",outlined:"",modelValue:s.newFormData.email,"onUpdate:modelValue":a[12]||(a[12]=e=>s.newFormData.email=e),label:e.$t("company.view_company.email")+" (Optional)",rules:[s.validate.email],maxlength:"255"},null,8,["modelValue","label","rules"]),(0,t.bF)(h,{dense:"",outlined:"",modelValue:s.newFormData.phone_number,"onUpdate:modelValue":a[13]||(a[13]=e=>s.newFormData.phone_number=e),label:e.$t("company.view_company.phone_number"),mask:"(##) #### - ### - ##",hint:"Eg: (09) 7773 - 777 - 17",rules:[s.validate.phone],maxlength:"20"},null,8,["modelValue","label","rules"]),(0,t.bF)(h,{dense:"",outlined:"",modelValue:s.newFormData.address,"onUpdate:modelValue":a[14]||(a[14]=e=>s.newFormData.address=e),label:e.$t("company.view_company.address")+" (Optional)",rules:[],maxlength:"255"},null,8,["modelValue","label"]),(0,t.bF)(h,{dense:"",outlined:"",modelValue:s.newFormData.phone_number2,"onUpdate:modelValue":a[15]||(a[15]=e=>s.newFormData.phone_number2=e),mask:"(##) #### - ### - ##",hint:"Eg: (09) 7773 - 777 - 17",label:e.$t("company.view_company.phone_number2")+" (Optional)",rules:[s.validate.phoneOpt],maxlength:"20"},null,8,["modelValue","label","rules"])])),_:1}),(0,t.bF)(A,{align:"right"},{default:(0,t.k6)((()=>[(0,t.bo)((0,t.bF)(u,{flat:"",label:s.t("cancel"),onClick:s.resetNewForm},null,8,["label","onClick"]),[[K]]),(0,t.bF)(u,{color:"primary",label:s.t("submit"),disable:!s.isNewFormValid,onClick:s.newDataSubmit},null,8,["label","disable","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(q,{modelValue:s.viewDialog,"onUpdate:modelValue":a[17]||(a[17]=e=>s.viewDialog=e),data:s.viewDataForm,title:e.$t("company.view_company.view_company_tip")},null,8,["modelValue","data","title"]),(0,t.bF)(D,{modelValue:s.deleteForm,"onUpdate:modelValue":a[18]||(a[18]=e=>s.deleteForm=e),persistent:""},{default:(0,t.k6)((()=>[(0,t.bF)(C,{class:"shadow-24",style:{"max-width":"350px",width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(F,{style:{height:"50px"},class:"bg-primary text-white"},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("company.view_company.delete"))+" ",1),(0,t.bF)(y),(0,t.bo)(((0,t.uX)(),(0,t.Wv)(u,{dense:"",flat:"",icon:"sym_r_close"},{default:(0,t.k6)((()=>[(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.close")),1)])),_:1})])),_:1})),[[K]])])),_:1}),(0,t.bF)(x,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(s.t("deletetip")),1)])),_:1}),(0,t.bF)(A,{align:"right"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{flat:"",label:s.t("cancel"),onClick:s.resetDelete},null,8,["label","onClick"]),(0,t.bF)(u,{color:"primary",label:s.t("delete"),onClick:s.deleteDataSubmit},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}l(317),l(95),l(6724),l(9240);var c=l(2261),m=l(1271),p=l(4907),u=l(7144),b=l(555),y=l(3537);const _={class:"row items-center"},h={class:"text-grey-7",style:{"min-width":"150px","font-weight":"500"}},g={class:"text-body1",style:{flex:"1","white-space":"pre-line","word-break":"break-word"}},v={__name:"ViewDialog",props:{modelValue:Boolean,data:Object},emits:["update:modelValue"],setup(e){return(a,l)=>{const o=(0,t.g2)("q-space"),i=(0,t.g2)("q-tooltip"),r=(0,t.g2)("q-btn"),d=(0,t.g2)("q-bar"),s=(0,t.g2)("q-separator"),c=(0,t.g2)("q-card-section"),m=(0,t.g2)("q-card"),p=(0,t.g2)("q-dialog"),u=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.Wv)(p,{"model-value":e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=e=>a.$emit("update:modelValue",e)),"transition-show":"scale","transition-hide":"scale"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{class:"shadow-24 column no-wrap",style:{"max-height":"90vh","max-width":"500px",width:"90vw"}},{default:(0,t.k6)((()=>[(0,t.bF)(d,{class:"bg-primary text-white rounded-borders",style:{height:"50px","flex-shrink":"0"}},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(a.$t("company.view_company.view_company_tip"))+" ",1),(0,t.bF)(o),(0,t.bo)(((0,t.uX)(),(0,t.Wv)(r,{dense:"",flat:"",icon:"sym_r_close"},{default:(0,t.k6)((()=>[(0,t.bF)(i,{class:"bg-gray text-white shadow-4"},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(a.$t("index.close")),1)])),_:1})])),_:1})),[[u]])])),_:1}),(0,t.bF)(c,{class:"scroll",style:{"overflow-y":"auto",flex:"1"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.data,((e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"q-py-sm"},[(0,t.Lk)("div",_,[(0,t.Lk)("div",h,(0,n.v_)(a.$t(`company.view_company.${l}`)),1),(0,t.Lk)("div",g,(0,n.v_)(e||"-"),1)]),(0,t.bF)(s,{spaced:""})])))),128))])),_:1})])),_:1})])),_:1},8,["model-value"])}}};var w=l(2156),f=l(3316),k=l(8670),F=l(3676),V=l(6384),x=l(7410),A=l(4189),C=l(386),D=l(8672),q=l(8582),K=l.n(q);const $=v,E=$;K()(v,"components",{QDialog:w.A,QCard:f.A,QBar:k.A,QSpace:F.A,QBtn:V.A,QTooltip:x.A,QCardSection:A.A,QSeparator:C.A}),K()(v,"directives",{ClosePopup:D.A});var Q=l(5677);const W={name:"PageCompanyList",components:{EditableCell:Q.A,ViewDialog:E},setup(){const{t:e}=(0,y.s9)(),a=(0,p.A)(),l="company",o=(0,b.KR)(!1),n=(0,b.KR)(m.A.getItem("userRole")),i=(0,b.KR)(m.A.getItem(l)||[]),r=(0,b.KR)(""),d=(0,b.KR)(1),s=(0,b.KR)(25),_=(0,b.KR)({page:1,rowsPerPage:s.value}),h=(0,b.KR)(1),g=(0,b.KR)(!1),v=(0,b.Kh)({name:"",company_type:"",email:"",phone_number:"",phone_number2:"",address:""}),w=(0,b.KR)(0),f=(0,b.KR)(!1),k=(0,b.Kh)({}),F=(0,b.Kh)({}),V=(0,b.KR)(!1),x=(0,b.KR)(0),A=(0,b.KR)(!1),C=(0,b.Kh)({}),D={class:"bg-blue text-white shadow-4",offset:[10,10],contentStyle:"font-size: 12px"},q="company.view_company.companyManu",K="company.view_company.companyRetail",$=(0,b.Kh)([{label:e(q),value:q},{label:e(K),value:K}]),E={required:a=>!!a||e("error.input.enterValue"),email:a=>!a||/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(a)||e("error.input.email"),phone:a=>a&&a.length>9&&/^[0-9()\-\s]+$/.test(a)||e("error.input.phoneValue"),phoneOpt:a=>!a||a.length>9&&/^[0-9()\-\s]+$/.test(a)||e("error.input.phoneValue")},Q=(0,t.EW)((()=>[E.required(v.name),E.required(v.company_type),E.phone(v.phone_number),E.phoneOpt(v.phone_number2),E.email(v.email)].every((e=>!0===e)))),W=(0,t.EW)((()=>[E.required(k.name),E.required(k.company_type),E.phone(k.phone_number),E.phoneOpt(k.phone_number2),E.email(k.email)].every((e=>!0===e)))),S=(0,t.EW)((()=>{if(!r.value)return i.value;const e=r.value.toLowerCase();return i.value.filter((a=>Object.values(a).some((a=>a?.toString().toLowerCase().includes(e)))))})),I=(0,t.EW)((()=>{const e=(d.value-1)*s.value;return S.value.slice(e,e+s.value)})),R=(0,t.EW)((()=>Math.ceil(S.value.length/s.value))),O=async()=>{o.value=!0,N(),await(0,u.e7)(l),i.value=m.A.getItem(l)||[],o.value=!1},U=()=>{i.value=m.A.getItem(l)||[],d.value=h.value=1},L=()=>{const e=Math.min(Math.max(Number(h.value),1),R.value||1);d.value=h.value=e},j=async()=>{if(Q.value)try{a.loading.show();const t={...v};t.company_type&&"object"===typeof t.company_type&&(t.company_type=t.company_type.value);const o=await(0,c.postauth)(`${l}/`,t);if("200"!==o.code)throw new Error;await O(),T(),a.notify({message:e("successful.create"),color:"green"})}catch{a.notify({message:e("error.create"),icon:"sym_r_close",color:"negative"})}finally{a.loading.hide()}else a.notify({message:e("error.data_invalid"),icon:"sym_r_close",color:"negative"})},T=()=>{Object.assign(v,{name:"",company_type:"",email:"",phone_number:"",phone_number2:"",address:""}),g.value=!1},X=e=>{f.value=!0,w.value=e.id,Object.assign(k,e),Object.assign(F,e)},B=async()=>{if(!W.value)return void a.notify({message:e("error.data_invalid"),icon:"sym_r_close",color:"negative"});const t=Object.fromEntries(Object.entries(k).filter((([e,a])=>a!==F[e])));if(!Object.keys(t).length)return a.notify({message:e("warning.no_changes"),color:"warning"});try{a.loading.show();const o=await(0,c.patchauth)(`${l}/${w.value}/`,t);if("200"!==o.code)throw new Error;await O(),N(),a.notify({message:e("successful.update"),color:"green"})}catch{a.notify({message:e("error.update"),color:"negative"})}finally{a.loading.hide()}},N=()=>{f.value=!1,w.value=0,Object.keys(k).forEach((e=>delete k[e]))},P=a=>{A.value=!0,Object.assign(C,a),delete C.id,delete C.update_time,C.company_type=e(C.company_type)},z=e=>{V.value=!0,x.value=e},M=async()=>{try{a.loading.show();const t=await(0,c.deleteauth)(`${l}/${x.value}/`);if("200"!==t.code)throw new Error;await O(),G(),a.notify({message:e("successful.delete"),color:"green"})}catch{a.notify({message:e("error.delete"),color:"negative"})}finally{a.loading.hide()}},G=()=>{V.value=!1,x.value=0},Z=e=>f.value&&e.row.id===w.value?{backgroundColor:"#cbc6d2"}:{},H=[{round:!0,flat:!0,push:!0,color:"green",icon:"sym_r_check",action:B},{round:!0,flat:!0,push:!0,color:"red",icon:"sym_r_close",action:N}],J=(0,b.Kh)([{field:"name",label:e("company.view_company.name"),rules:[E.required],truncate:!0,truncateLength:35},{field:"company_type",label:e("company.view_company.company_type"),rules:[E.required],truncate:!1,translate:!0,options:$},{field:"email",label:e("company.view_company.email"),rules:[E.email],truncate:!1},{field:"phone_number",label:e("company.view_company.phone_number"),rules:[E.phone],truncate:!1,mask:"(##) #### - ### - ##"},{field:"phone_number2",label:e("company.view_company.phone_number2"),rules:[E.phoneOpt],truncate:!1,mask:"(##) #### - ### - ##"},{field:"address",label:e("company.view_company.address"),rules:[null],truncate:!0,truncateLength:35}]),Y=[{round:!0,flat:!0,push:!0,color:"amber-2",icon:"sym_r_visibility",tip:e("index.view_detail"),action:P},{round:!0,flat:!0,push:!0,color:"amber-4",icon:"sym_r_edit",tip:e("edit"),action:X},{round:!0,flat:!0,push:!0,color:"amber-13",icon:"sym_r_delete",tip:e("delete"),action:e=>z(e.id)}],ee=a=>{const l=[{name:"code",label:e("company.view_company.code"),field:"code",align:"center",sortable:!0},{name:"name",label:e("company.view_company.name"),field:"name",align:"left",sortable:!0},{name:"company_type",label:e("company.view_company.company_type"),field:"company_type",align:"left",sortable:!0},{name:"email",label:e("company.view_company.email"),field:"email",align:"left"},{name:"phone_number",label:e("company.view_company.phone_number"),field:"phone_number",align:"center"},{name:"phone_number2",label:e("company.view_company.phone_number2"),field:"phone_number2",align:"center"},{name:"address",label:e("company.view_company.address"),field:"address",align:"left"}],t=[{name:"creator",label:e("company.view_company.creator"),field:"creator",align:"left",sortable:!0},{name:"create_time",label:e("company.view_company.create_time"),field:"create_time",align:"left",sortable:!0}],o={name:"action",label:e("action"),align:"center"};return[...l.map((e=>({...e,headerStyle:"font-weight: bold; font-size: 13px"}))),..."Admin"===a?t.map((e=>({...e,headerStyle:"font-weight: bold; font-size: 13px"}))):[],{...o,headerStyle:"font-weight: bold; font-size: 13px"}]},ae=(0,b.Kh)(ee(n.value));return(0,t.sV)((()=>{i.value.length||O()})),{pathname:l,loading:o,tableList:i,filter:r,pagination:_,newForm:g,newFormData:v,editId:w,editFormData:k,editMode:f,deleteForm:V,deleteId:x,current:d,max:R,paginationIpt:h,changePageEnter:L,getSearchList:U,newDataSubmit:j,editData:X,editDataSubmit:B,editDataCancel:N,deleteData:z,deleteDataSubmit:M,columns:ae,isEditFormValid:W,isNewFormValid:Q,t:e,tooltip:D,q:a,companyTypeOpt:$,paginatedRows:I,userRole:n,originalFormData:F,viewDialog:A,viewDataForm:C,viewData:P,actionCellStyle:Z,rowActions:Y,resetNewForm:T,resetDelete:G,fetchTableData:O,validate:E,editableColumns:J,editActions:H}}};var S=l(2807),I=l(6653),R=l(6031),O=l(9270),U=l(492),L=l(4488),j=l(5262),T=l(4700),X=l(4940),B=l(2669);const N=(0,S.A)(W,[["render",s]]),P=N;K()(W,"components",{QTable:I.A,QBtnGroup:R.A,QBtn:V.A,QTooltip:x.A,QSpace:F.A,QInput:O.A,QIcon:U.A,QTr:L.A,QTd:j.A,QPagination:T.A,QDialog:w.A,QCard:f.A,QBar:k.A,QCardSection:A.A,QSelect:X.A,QCardActions:B.A}),K()(W,"directives",{ClosePopup:D.A})}}]);