"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[702],{9702:(e,t,a)=>{a.r(t),a.d(t,{default:()=>oe});var o=a(1758),l=a(2901);const n={class:"page-controls q-pa-md row items-center justify-between"},s={class:"row items-center q-gutter-sm"},i={class:"text-caption"},r={class:"row items-center q-gutter-sm"},d={class:"preview-wrap q-pa-md"},c={class:"print-header row items-center justify-between"},u={class:"company-name"},m={class:"company-address"},v={class:"meta text-right"},g={class:"consignment-info row q-col-gutter-md q-mt-md"},p={class:"col-6"},y={class:"label"},k={class:"value"},_={class:"sub"},L={class:"col-6 text-right"},b={class:"label"},h={class:"value"},w={class:"sub"},f={class:"items-section q-mt-lg"},x={class:"items-table"},N={style:{width:"46%"}},q={style:{width:"16%"}},C={style:{width:"16%"}},P={style:{width:"16%"}},S={key:0},I={class:"text-center"},A={class:"item-name"},z={class:"item-note text-caption text-grey"},O={class:"text-right"},$={class:"text-right"},F={class:"text-right"},R={class:"text-right"},T={class:"text-right"},W={class:"text-right"},D={class:"text-right"},E={class:"print-footer row items-center q-mt-lg"},V={class:"col-6"},B={class:"text-caption text-grey"},K={class:"col-6 text-right"},G={class:"text-caption text-grey"};function Q(e,t,a,Q,X,j){const J=(0,o.g2)("q-btn"),M=(0,o.g2)("q-select"),U=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(U,{class:"page-print-container"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",n,[(0,o.Lk)("div",s,[(0,o.bF)(J,{dense:"",flat:"",icon:"sym_r_arrow_back",onClick:Q.goBack,label:"Back"},null,8,["onClick"]),(0,o.bF)(M,{dense:"",outlined:"",style:{"min-width":"160px"},modelValue:Q.pageSize,"onUpdate:modelValue":t[0]||(t[0]=e=>Q.pageSize=e),options:Q.pageSizeOptions,label:"Page size"},null,8,["modelValue","options"]),(0,o.bF)(M,{dense:"",outlined:"",style:{"min-width":"160px"},modelValue:Q.orientation,"onUpdate:modelValue":t[1]||(t[1]=e=>Q.orientation=e),options:Q.orientationOptions,label:"Orientation"},null,8,["modelValue","options"]),(0,o.bF)(J,{dense:"",flat:"",icon:"sym_r_zoom_in",onClick:Q.zoomIn},null,8,["onClick"]),(0,o.bF)(J,{dense:"",flat:"",icon:"sym_r_zoom_out",onClick:Q.zoomOut},null,8,["onClick"]),(0,o.Lk)("div",i,"Zoom: "+(0,l.v_)(Math.round(100*Q.zoom))+"%",1)]),(0,o.Lk)("div",r,[(0,o.bF)(J,{color:"primary",unelevated:"",icon:"sym_r_print",onClick:Q.printPreview,loading:Q.printing},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)(" Print / Save PDF ")]))),_:1},8,["onClick","loading"]),(0,o.bF)(J,{color:"secondary",flat:"",icon:"sym_r_download",onClick:Q.downloadAsPdf,loading:Q.printing},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" Download (print dialog) ")]))),_:1},8,["onClick","loading"])])]),(0,o.Lk)("div",d,[(0,o.Lk)("div",{ref:"printable",class:(0,l.C4)(["print-page",`${Q.pageSizeClass} ${Q.orientation}`]),style:(0,l.Tr)(Q.previewStyle)},[(0,o.Lk)("header",c,[(0,o.Lk)("div",null,[(0,o.Lk)("div",u,(0,l.v_)(Q.data?.company?.name||Q.data?.companyName||"â€”"),1),(0,o.Lk)("div",m,(0,l.v_)(Q.data?.company?.address||""),1)]),(0,o.Lk)("div",v,[(0,o.Lk)("div",null,[(0,o.Lk)("strong",null,(0,l.v_)(e.$t("receivegoods.view_receivegoods.title")||"Receive Goods"),1)]),(0,o.Lk)("div",null,(0,l.v_)(e.$t("receivegoods.view_receivegoods.date")||"Date")+": "+(0,l.v_)(Q.displayDate),1),(0,o.Lk)("div",null,"Ref: "+(0,l.v_)(Q.data?.ref||Q.data?.consignmentId||"-"),1)])]),t[12]||(t[12]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("section",g,[(0,o.Lk)("div",p,[(0,o.Lk)("div",y,(0,l.v_)(e.$t("receivegoods.view_receivegoods.customer")||"Customer"),1),(0,o.Lk)("div",k,(0,l.v_)(Q.data?.customer?.name||Q.data?.customerName||"-"),1),(0,o.Lk)("div",_,(0,l.v_)(Q.data?.customer?.address||""),1)]),(0,o.Lk)("div",L,[(0,o.Lk)("div",b,(0,l.v_)(e.$t("receivegoods.view_receivegoods.company")||"Company"),1),(0,o.Lk)("div",h,(0,l.v_)(Q.data?.company?.name||Q.data?.companyName||"-"),1),(0,o.Lk)("div",w,(0,l.v_)(Q.data?.company?.phone||""),1)])]),(0,o.Lk)("section",f,[(0,o.Lk)("table",x,[(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[t[4]||(t[4]=(0,o.Lk)("th",{style:{width:"6%"}},"#",-1)),(0,o.Lk)("th",N,(0,l.v_)(e.$t("receivegoods.view_receivegoods.particular")||"Particular"),1),(0,o.Lk)("th",q,(0,l.v_)(e.$t("receivegoods.view_receivegoods.quantity")||"Qty"),1),(0,o.Lk)("th",C,(0,l.v_)(e.$t("receivegoods.view_receivegoods.rate")||"Rate"),1),(0,o.Lk)("th",P,(0,l.v_)(e.$t("receivegoods.view_receivegoods.total")||"Total"),1)])]),(0,o.Lk)("tbody",null,[Q.lineItems&&Q.lineItems.length?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("tr",S,t[5]||(t[5]=[(0,o.Lk)("td",{colspan:"5",class:"text-center text-grey"},"No items",-1)]))),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Q.lineItems,((e,t)=>((0,o.uX)(),(0,o.CE)("tr",{key:`prow-${t}`},[(0,o.Lk)("td",I,(0,l.v_)(t+1),1),(0,o.Lk)("td",null,[(0,o.Lk)("div",A,(0,l.v_)(e?.goods_name||e?.name||e?.label||"-"),1),(0,o.Lk)("div",z,(0,l.v_)(e?.note||""),1)]),(0,o.Lk)("td",O,(0,l.v_)(Q.formatNumber(e?.quantity)),1),(0,o.Lk)("td",$,(0,l.v_)(Q.formatCurrency(e?.goods_rate)),1),(0,o.Lk)("td",F,(0,l.v_)(Q.formatCurrency(e?.goods_total||Number(e?.quantity||0)*Number(e?.goods_rate||0))),1)])))),128))]),(0,o.Lk)("tfoot",null,[(0,o.Lk)("tr",null,[t[6]||(t[6]=(0,o.Lk)("td",{colspan:"3"},null,-1)),(0,o.Lk)("td",R,[(0,o.Lk)("strong",null,(0,l.v_)(e.$t("receivegoods.view_receivegoods.grandTotalAmount")||"Grand Total"),1)]),(0,o.Lk)("td",T,[(0,o.Lk)("strong",null,(0,l.v_)(Q.formatCurrency(Q.summary.totalAmount)),1)])]),(0,o.Lk)("tr",null,[t[7]||(t[7]=(0,o.Lk)("td",{colspan:"3"},null,-1)),(0,o.Lk)("td",W,[(0,o.Lk)("strong",null,(0,l.v_)(e.$t("receivegoods.view_receivegoods.grandTotalWeight")||"Total Weight"),1)]),(0,o.Lk)("td",D,[(0,o.Lk)("strong",null,(0,l.v_)(Q.formatNumber(Q.summary.totalWeight)),1)])])])])]),t[13]||(t[13]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("footer",E,[(0,o.Lk)("div",V,[t[8]||(t[8]=(0,o.Lk)("div",{class:"text-caption text-grey"},"Prepared by",-1)),t[9]||(t[9]=(0,o.Lk)("div",{class:"sig-line"},null,-1)),(0,o.Lk)("div",B,(0,l.v_)(Q.data?.preparedBy||"-"),1)]),(0,o.Lk)("div",K,[t[10]||(t[10]=(0,o.Lk)("div",{class:"text-caption text-grey"},"Received by",-1)),t[11]||(t[11]=(0,o.Lk)("div",{class:"sig-line",style:{"margin-left":"auto",width:"220px"}},null,-1)),(0,o.Lk)("div",G,(0,l.v_)(Q.data?.receivedBy||"-"),1)])])],6)]),t[14]||(t[14]=(0,o.Lk)("div",{class:"q-pa-sm text-caption text-grey-6"}," Previewing printable layout. Use Print or Download to export. ",-1))])),_:1})}a(310),a(6724),a(2802);var X=a(555),j=a(4907),J=a(455);const M={name:"ReceiveGoodsPrint",props:{payload:{type:Object,default:null}},setup(e){const t=(0,j.A)(),a=(0,J.lq)(),l=(0,J.rd)(),n=(0,X.KR)(!1),s=(0,X.KR)(1),i=(0,X.KR)("A4"),r=(0,X.KR)("portrait"),d=[{label:"A4",value:"A4"},{label:"Letter",value:"Letter"}],c=[{label:"Portrait",value:"portrait"},{label:"Landscape",value:"landscape"}],u=(0,X.KR)(null),m=()=>{if(e.payload)u.value=v(e.payload);else{try{const e=a?.query?.payload;if(e)return void(u.value=v(JSON.parse(e)))}catch(e){}try{const e=localStorage.getItem("ReceiveGoodsPrintPayload");e&&(u.value=v(JSON.parse(e)))}catch(e){u.value=null}}},v=e=>{const t={...e||{}};return t.lineItems=Array.isArray(e?.lineItems)?e.lineItems.map((e=>({goods_name:e.goods_name||e.name||e.label||(e.goods?.name??null),quantity:e.quantity??e.qty??0,goods_rate:e.goods_rate??e.rate??0,goods_weight:e.goods_weight??e.weight??0,goods_total:e.goods_total??Number(e.quantity||0)*Number(e.goods_rate||0),note:e.note||""}))):[],t.company=t.company||{name:t.companyName||"",address:t.companyAddress||"",phone:t.companyPhone||""},t.customer=t.customer||{name:t.customerName||"",address:t.customerAddress||""},t},g=(0,o.EW)((()=>(u.value?.lineItems||[]).map((e=>({...e,quantity:Number(e.quantity||0),goods_rate:Number(e.goods_rate||0),goods_total:Number(e.goods_total??Number(e.quantity||0)*Number(e.goods_rate||0)),goods_weight:Number(e.goods_weight||0)}))))),p=(0,o.EW)((()=>{const e=g.value.reduce(((e,t)=>e+(Number(t.goods_total)||0)),0),t=g.value.reduce(((e,t)=>e+Number(t.goods_weight||0)*Number(t.quantity||0)),0);return{totalAmount:e,totalWeight:t}})),y=(0,o.EW)((()=>{const e=u.value?.date||u.value?.received_date||(new Date).toISOString().split("T")[0].replace(/-/g,"/");if(!e)return"-";try{if(e.includes("T")){const t=new Date(e);return t.toISOString().split("T")[0].replace(/-/g,"/")}return e}catch(t){return e}})),k=e=>{const t=Number(e||0);return(new Intl.NumberFormat).format(t)},_=e=>{const t=Number(e||0);return new Intl.NumberFormat(void 0,{maximumFractionDigits:2}).format(t)},L=()=>{s.value=Math.min(2,s.value+.1)},b=()=>{s.value=Math.max(.4,s.value-.1)},h=(0,o.EW)((()=>"A4"===i.value?"pg-a4":"pg-letter")),w=(0,o.EW)((()=>({transform:`scale(${s.value})`,transformOrigin:"top left"}))),f=()=>{window.history.length>1?l.back():l.push({name:"index"}).catch((()=>{}))},x=async()=>{try{n.value=!0,await q(120),window.print()}catch(e){t.notify({type:"negative",message:"Print failed: "+(e?.message||e)})}finally{n.value=!1}},N=async()=>{await x()},q=e=>new Promise((t=>setTimeout(t,e)));return(0,o.sV)((()=>{if(m(),e.payload)try{localStorage.setItem("ReceiveGoodsPrintPayload",JSON.stringify(e.payload))}catch{}})),{printing:n,zoom:s,pageSize:i,pageSizeOptions:d,orientation:r,orientationOptions:c,pageSizeClass:h,previewStyle:w,data:u,lineItems:g,summary:p,displayDate:y,formatNumber:k,formatCurrency:_,zoomIn:L,zoomOut:b,printPreview:x,downloadAsPdf:N,goBack:f}}};var U=a(2807),Z=a(7716),H=a(6384),Y=a(4940),ee=a(8582),te=a.n(ee);const ae=(0,U.A)(M,[["render",Q],["__scopeId","data-v-326bff64"]]),oe=ae;te()(M,"components",{QPage:Z.A,QBtn:H.A,QSelect:Y.A})}}]);