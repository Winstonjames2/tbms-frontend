"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[222],{2222:(e,l,a)=>{a.r(l),a.d(l,{default:()=>Z});var t=a(1758),n=a(2901),o=a(6683);const i={class:"q-ml-auto"},s={class:"text-subtitle1 text-center q-mx-auto",style:{"text-transform":"capitalize","align-items":"center","align-self":"center"}};function r(e,l,a,r,u,d){const c=(0,t.g2)("q-tooltip"),m=(0,t.g2)("q-btn"),g=(0,t.g2)("q-toolbar-title"),k=(0,t.g2)("q-item-label"),b=(0,t.g2)("q-item"),_=(0,t.g2)("q-separator"),p=(0,t.g2)("q-item-section"),f=(0,t.g2)("q-list"),h=(0,t.g2)("q-menu"),v=(0,t.g2)("q-icon"),y=(0,t.g2)("q-img"),F=(0,t.g2)("q-avatar"),A=(0,t.g2)("q-toolbar"),w=(0,t.g2)("q-header"),C=(0,t.g2)("q-scroll-area"),x=(0,t.g2)("q-drawer"),I=(0,t.g2)("router-view"),L=(0,t.g2)("q-page-container"),q=(0,t.g2)("q-space"),R=(0,t.g2)("q-bar"),Q=(0,t.g2)("q-input"),K=(0,t.g2)("q-card-section"),W=(0,t.g2)("q-card-actions"),N=(0,t.g2)("q-card"),D=(0,t.g2)("q-dialog"),T=(0,t.g2)("q-layout"),E=(0,t.gN)("close-popup"),$=(0,t.gN)("ripple");return(0,t.uX)(),(0,t.Wv)(T,{view:"hHh LpR fFf",style:(0,n.Tr)({height:r.q.screen.height,width:r.q.screen.width})},{default:(0,t.k6)((()=>[(0,t.bF)(w,{reveal:"",class:"bg-primary",bordered:""},{default:(0,t.k6)((()=>[(0,t.bF)(A,null,{default:(0,t.k6)((()=>[(0,t.bF)(m,{flat:"",onClick:l[0]||(l[0]=e=>r.drawerleft=!r.drawerleft),dense:"",icon:r.drawerleft?"sym_r_left_panel_close":"sym_r_left_panel_open"},{default:(0,t.k6)((()=>[(0,t.bF)(c,(0,n._B)((0,t.Ng)(r.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(r.drawerleft?e.$t("index.conceal_menu"):e.$t("index.show_menu")),1)])),_:1},16)])),_:1},8,["icon"]),(0,t.bF)(g,{shrink:"",class:"main-title",onClick:l[1]||(l[1]=e=>r.router.push({name:"web_index"}))},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.title")),1)])),_:1}),(0,t.Lk)("div",i,[(0,t.bF)(m,{round:"",dense:"",flat:"",icon:"sym_r_brightness_6",class:"q-mx-sm",color:"text",onClick:r.toggleTheme},{default:(0,t.k6)((()=>[(0,t.bF)(c,(0,n._B)((0,t.Ng)(r.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.change_theme")),1)])),_:1},16)])),_:1},8,["onClick"]),(0,t.bF)(m,{round:"",dense:"",flat:"",icon:"sym_r_notifications",class:"q-mx-sm",color:"text"},{default:(0,t.k6)((()=>[(0,t.bF)(c,(0,n._B)((0,t.Ng)(r.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.notifications")),1)])),_:1},16),(0,t.bF)(h,null,{default:(0,t.k6)((()=>[(0,t.bF)(f,{style:{"min-width":"150px",padding:"5px","font-size":"0.8em"},class:"shadow-4"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{style:{"font-size":"1.3em"}},{default:(0,t.k6)((()=>[(0,t.bF)(k,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.notifications")),1)])),_:1})])),_:1}),(0,t.bF)(_),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.recentNotifications,((e,l)=>((0,t.uX)(),(0,t.Wv)(b,{key:l,style:{padding:"0 5px"}},{default:(0,t.k6)((()=>[(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(l+1+". "+e),1)])),_:2},1024)])),_:2},1024)))),128)),(0,t.bF)(_),(0,t.bF)(b,{clickable:"",onClick:e.seeMoreNotifications,style:{padding:"5px",color:"blue","text-decoration":"underline"}},{default:(0,t.k6)((()=>[(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.see_more")),1)])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(m,{round:"",dense:"",flat:"",icon:"sym_r_translate",class:"q-mx-sm",color:"text"},{default:(0,t.k6)((()=>[(0,t.bF)(c,(0,n._B)((0,t.Ng)(r.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.translate")),1)])),_:1},16),(0,t.bF)(h,null,{default:(0,t.k6)((()=>[(0,t.bF)(f,{style:{"min-width":"100px"},class:"shadow-4"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.langOptions,((e,l)=>(0,t.bo)(((0,t.uX)(),(0,t.Wv)(b,{key:l,clickable:"",onClick:l=>r.langChange(e.value),active:r.currentLang===e.value,"active-class":"bg-primary text-white"},{default:(0,t.k6)((()=>[(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.label),1)])),_:2},1024),r.currentLang===e.value?((0,t.uX)(),(0,t.Wv)(p,{key:0,side:""},{default:(0,t.k6)((()=>[(0,t.bF)(v,{name:"sym_r_check",color:"white",size:"16px"})])),_:1})):(0,t.Q3)("",!0)])),_:2},1032,["onClick","active"])),[[E]]))),128))])),_:1})])),_:1})])),_:1})]),(0,t.bF)(_,{vertical:"",color:"primary",class:"q-my-xs"}),null!==r.displayName?((0,t.uX)(),(0,t.Wv)(m,{key:0,stretch:"",flat:"",color:"white-8",icon:"sym_r_account_circle"},{default:(0,t.k6)((()=>[(0,t.bF)(h,null,{default:(0,t.k6)((()=>[(0,t.bF)(f,{class:"q-pa-none"},{default:(0,t.k6)((()=>[(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.bF)(F,{size:"60px",class:"q-mx-auto"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{src:"statics/icons/tb_icon.jpg"})])),_:1})])),_:1}),(0,t.bF)(_),(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.Lk)("div",s,(0,n.v_)(r.displayName),1)])),_:1}),(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(m,{color:"primary",label:e.$t("index.logout"),push:"",size:"sm",onClick:r.userLogout},{default:(0,t.k6)((()=>[(0,t.bF)(c,(0,n._B)((0,t.Ng)(r.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.logout")),1)])),_:1},16)])),_:1},8,["label","onClick"])),[[E]])])),_:1})])),_:1})])),_:1})])),_:1})):(0,t.Q3)("",!0),null===r.displayName?((0,t.uX)(),(0,t.Wv)(m,{key:1,label:e.$t("index.login"),color:"primary",onClick:l[2]||(l[2]=e=>r.loginDialog=!0),style:{"margin-left":"10px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,(0,n._B)((0,t.Ng)(r.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("index.login_tip")),1)])),_:1},16)])),_:1},8,["label"])):(0,t.Q3)("",!0)])),_:1})])),_:1}),(0,t.bF)(x,{modelValue:r.drawerleft,"onUpdate:modelValue":l[4]||(l[4]=e=>r.drawerleft=e),"show-if-above":"",width:220,breakpoint:500,class:"left-drawer"},{default:(0,t.k6)((()=>[(0,t.bF)(C,{class:"fit"},{default:(0,t.k6)((()=>[(0,t.bF)(f,null,{default:(0,t.k6)((()=>["Admin"===r.userRole||"Staff"===r.userRole?(0,t.bo)(((0,t.uX)(),(0,t.Wv)(b,{key:0,clickable:"",to:{name:"ViewDashboard"},active:"Dashboard"===r.link,onClick:l[3]||(l[3]=e=>r.linkChange("Dashboard")),class:(0,n.C4)(["menu-link",{"selected-menu-link":"Dashboard"===r.link}])},{default:(0,t.k6)((()=>[(0,t.bF)(p,{avatar:""},{default:(0,t.k6)((()=>[(0,t.bF)(v,{name:"sym_r_dashboard"})])),_:1}),(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t("menuItem.dashboard")),1)])),_:1})])),_:1},8,["active","class"])),[[$]]):(0,t.Q3)("",!0),"Admin"===r.userRole||"Staff"===r.userRole?((0,t.uX)(),(0,t.Wv)(_,{key:1,spaced:""})):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.menuItems1,(l=>(0,t.bo)(((0,t.uX)(),(0,t.Wv)(b,{key:l.link,clickable:"",to:l.to,active:r.link===l.link,onClick:e=>r.linkChange(l.link),class:(0,n.C4)(["menu-link",{"selected-menu-link":r.link===l.link}])},{default:(0,t.k6)((()=>[(0,t.bF)(p,{avatar:""},{default:(0,t.k6)((()=>[(0,t.bF)(v,{name:l.icon},null,8,["name"])])),_:2},1024),(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t(l.label)),1)])),_:2},1024)])),_:2},1032,["to","active","onClick","class"])),[[$]]))),128)),(0,t.bF)(_,{spaced:""}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.menuItems2,(l=>(0,t.bo)(((0,t.uX)(),(0,t.Wv)(b,{key:l.link,clickable:"",to:l.to,active:r.link===l.link,onClick:e=>r.linkChange(l.link),class:(0,n.C4)(["menu-link",{"selected-menu-link":r.link===l.link}])},{default:(0,t.k6)((()=>[(0,t.bF)(p,{avatar:""},{default:(0,t.k6)((()=>[(0,t.bF)(v,{name:l.icon},null,8,["name"])])),_:2},1024),(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t(l.label)),1)])),_:2},1024)])),_:2},1032,["to","active","onClick","class"])),[[$]]))),128)),(0,t.bF)(_,{spaced:""}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.menuItems3,(l=>(0,t.bo)(((0,t.uX)(),(0,t.Wv)(b,{key:l.link,clickable:"",to:l.to,active:r.link===l.link,onClick:e=>r.linkChange(l.link),class:(0,n.C4)(["menu-link",{"selected-menu-link":r.link===l.link}])},{default:(0,t.k6)((()=>[(0,t.bF)(p,{avatar:""},{default:(0,t.k6)((()=>[(0,t.bF)(v,{name:l.icon},null,8,["name"])])),_:2},1024),(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.$t(l.label)),1)])),_:2},1024)])),_:2},1032,["to","active","onClick","class"])),[[$]]))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(L,{class:"main-page",style:(0,n.Tr)({height:r.q.screen.height,width:r.q.screen.width})},{default:(0,t.k6)((()=>[(0,t.bF)(I)])),_:1},8,["style"]),(0,t.bF)(D,{modelValue:r.loginDialog,"onUpdate:modelValue":l[8]||(l[8]=e=>r.loginDialog=e),"transition-show":"jump-down","transition-hide":"jump-up"},{default:(0,t.k6)((()=>[(0,t.bF)(N,{style:{"min-width":"350px"}},{default:(0,t.k6)((()=>[(0,t.bF)(R,{class:"bg-accent text-black rounded-borders",style:{height:"50px"}},{default:(0,t.k6)((()=>[(0,t.Lk)("div",null,(0,n.v_)(e.$t("index.login")),1),(0,t.bF)(q)])),_:1}),(0,t.bF)(K,{class:"q-pt-md"},{default:(0,t.k6)((()=>[(0,t.bF)(Q,{dense:"",outlined:"",square:"",label:e.$t("index.email"),hint:"Hint: example@tblogistic.com",modelValue:r.loginform.email,"onUpdate:modelValue":l[5]||(l[5]=e=>r.loginform.email=e),onKeyup:(0,o.jR)(r.userLogin,["enter"])},null,8,["label","modelValue","onKeyup"]),(0,t.bF)(Q,{dense:"",outlined:"",square:"",label:e.$t("index.password"),modelValue:r.loginform.password,"onUpdate:modelValue":l[7]||(l[7]=e=>r.loginform.password=e),type:r.isPwd?"password":"text",onKeyup:(0,o.jR)(r.userLogin,["enter"]),class:"q-mt-sm"},{append:(0,t.k6)((()=>[(0,t.bF)(v,{name:r.isPwd?"sym_r_visibility_off":"sym_r_visibility",class:"cursor-pointer",onClick:l[6]||(l[6]=e=>r.isPwd=!r.isPwd)},null,8,["name"])])),_:1},8,["label","modelValue","type","onKeyup"])])),_:1}),(0,t.bF)(W,{align:"right"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{class:"full-width",color:"primary",label:e.$t("index.login"),onClick:r.userLogin},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["style"])}a(310),a(95);var u=a(1271),d=a(4907),c=a(6308),m=a(555),g=a(3537),k=a(8064),b=a(455),_=a(2261),p=a(466),f=a.n(p),h=a(7144);function v(){const e=(0,d.A)(),l=(0,b.rd)(),a=(0,m.KR)(!1),n=(0,m.KR)(!1),o=(0,m.KR)({email:"",password:""}),i=(0,m.KR)(u.A.getItem("displayName")||null),s=(0,m.KR)(u.A.getItem("userRole")||null),r=(0,m.KR)(u.A.getItem("userId")||null),c=l=>e.notify({message:l,icon:"sym_r_check",color:"positive"}),g=l=>e.notify({message:l,icon:"sym_r_close",color:"negative"}),k=async()=>{if(!o.value.email.trim())return g("Please Enter Email");if(!o.value.password.trim())return g("Please Enter Password");a.value=!0,e.loading.show({spinnerColor:"primary",message:"Loggin in..."});try{const a=await(0,_.post)("UserAccount/login/",o.value);console.log(a),"200"===a.code?(u.A.set("accessToken",a.data.access),u.A.set("refreshToken",a.data.refresh),u.A.set("tokenExpiration",f()().add(30,"minute").toISOString()),u.A.set("displayName",a.data.displayName),u.A.set("auth",!0),u.A.set("userRole",a.data.role),u.A.set("userId",a.data.user_id),i.value=a.data.displayName,s.value=a.data.role,r.value=a.data.user_id,c("Login Successful"),l.push({name:"web_index"}),n.value=!1,e.loading.show({spinnerColor:"positive",message:"Loading Data..."}),await y()):g("Login Failed: "+a.data.message)}catch(e){g(`Login Failed: ${e}`)}finally{a.value=!1,e.loading.hide()}},p=()=>{e.loading.show(),console.log("Logging out..."),(0,_.post)("UserAccount/logout/").finally((()=>{["accessToken","refreshToken","displayName","menulink","tokenExpiration","auth","customer","company","goods","goodstype","truck"].forEach(u.A.remove),u.A.remove("userRole"),u.A.remove("userId"),c("Logged Out"),l.push({name:"web_index"}),e.loading.hide(),setTimeout((()=>location.reload()),100)}))},v=async()=>{const e=u.A.getItem("accessToken"),l=u.A.getItem("refreshToken");if(!e||!l)return g("Login Required"),void(n.value=!0);if(!s.value||!r.value){const e=await(0,_.getauth)("UserAccount/userRole");"200"===e?.data?.code||"200"===e?.code?(u.A.set("userRole",e.data.role),u.A.set("userId",e.data.user_id),s.value=e.data.role,r.value=e.data.user_id):(g("Failed to retrieve user role."),g("Please log in again."),n.value=!0,p())}};(0,t.sV)((()=>{v()}));const y=async()=>{try{const e=["customer","company","goods","goodstype","truck","truckdriver"];e.forEach((e=>u.A.remove(e))),Object.keys(window.localStorage).forEach((l=>{e.some((e=>l.includes(e)))&&u.A.remove(l)})),await Promise.all(e.map((async e=>{await(0,h.e7)(e,null,e)}))),c("Data Loaded")}catch(e){g("Data Load Failed: "+e)}};return{loginform:o,loginDialog:n,displayName:i,userId:r,userRole:s,userLogin:k,userLogout:p,checkAuthentication:v}}const y={setup(){const{loginform:e,loginDialog:l,displayName:a,userId:n,userRole:o,userLogin:i,userLogout:s,checkAuthentication:r}=v(),{t:_}=(0,g.s9)(),p=(0,d.A)(),f=(0,b.rd)(),y=(0,m.KR)(!1),F=(0,m.KR)(u.A.getItem("device")||""),A=(0,m.KR)(u.A.getItem("deviceName")||""),w=(0,m.KR)(k.i18n.global.locale),C=(0,m.KR)(_("index.webtitle")),x=(0,m.KR)(!0),I=(0,m.KR)(!1),L=(0,m.KR)(u.A.getItem("menulink")||""),q=(0,m.KR)(1),R={class:"bg-blue text-white shadow-4",offset:[10,10],contentStyle:"font-size: 12px"},Q=u.A.getItem("theme");null!==Q&&void 0!==Q&&p.dark.set("dark"===Q);const K=()=>{const e=p.dark.isActive?"light":"dark";p.dark.set("dark"===e),u.A.set("theme",e)},W=(0,m.KR)(["You have a new message","Your order has been shipped","Update available for your app"]),N=(0,m.Kh)([{value:"en-US",label:"English"},{value:"mm",label:"Myanmar"},{value:"mmEn",label:"Myanmar-English"},{value:"zh-CN",label:"Chinese (Simplified)"}]),D=(0,t.EW)((()=>w.value));console.log("Current Language from storage:",D.value),(0,t.wB)(w,(e=>u.A.set("lang",e)));const T=e=>{w.value=e},E=(0,m.Kh)([{label:"menuItem.receivegoods",link:"ReceiveGoods",to:{name:"ReceiveGoods"},icon:"sym_r_archive"},{label:"menuItem.customer",link:"Customer",to:{name:"CustomerList"},icon:"sym_r_people"},{label:"menuItem.company",link:"CompanyList",to:{name:"CompanyList"},icon:"sym_r_business"},{label:"menuItem.goods",link:"Goods",to:{name:"GoodsList"},icon:"sym_r_inventory_2"},{label:"menuItem.truck",link:"TruckList",to:{name:"TruckList"},icon:"sym_r_local_shipping"}]),$=(0,m.Kh)([{label:"menuItem.inventory",link:"Inventory",to:{name:"InventoryList"},icon:"sym_r_warehouse"},{label:"menuItem.dispatchPlanning",link:"DispatchPlanning",to:{name:"PackageGroupList"},icon:"sym_r_assignment"},{label:"menuItem.truckdispatch",link:"TruckDispatch",to:{name:"TruckDispatchList"},icon:"sym_r_view_agenda"}]),P=(0,m.Kh)([{label:"menuItem.tracking",link:"TrackVehicle",to:{name:"TrackVehicle"},icon:"sym_r_location_on"}]),S=()=>p.screen.height>=380&&p.screen.width>=750,V=()=>{S(),I.value=p.screen.width>=1e3};(0,t.sV)((()=>{V(),window.addEventListener("resize",V),c["default"].on("needlogin",r()),(0,h.Fd)()}));const X=e=>{u.A.set("menulink",e),L.value=e,["rc_detailLink","selectedPG","dispatch_detailLink","truckDispatchData","PackageGroupData","SelectedInventoryItemData","EditSelectedInventoryItemData"].forEach(u.A.remove)};(0,t.wB)((()=>f.currentRoute.value),(e=>{const l=u.A.getItem("pending_link_change");l&&(u.A.set("menulink",l),u.A.remove("pending_link_change"),L.value=l)}),{immediate:!0});const{locale:B}=(0,g.s9)();return(0,t.wB)(B,(e=>{document.documentElement.setAttribute("lang",e),document.body.classList.forEach((e=>{e.startsWith("lang-")&&document.body.classList.remove(e)})),document.body.classList.add(`lang-${e}`)}),{immediate:!0}),{q:p,router:f,loading:y,device:F,deviceName:A,lang:w,toggleTheme:K,langOptions:N,title:C,loginform:e,loginDialog:l,displayName:a,userId:n,userRole:o,isPwd:x,userLogin:i,userLogout:s,checkAuthentication:r,drawerleft:I,link:L,current:q,langChange:T,linkChange:X,menuItems1:E,menuItems2:$,menuItems3:P,isDeviceSupported:S,recentNotifications:W,tooltip:R,currentLang:D}}};var F=a(2807),A=a(2008),w=a(8416),C=a(6914),x=a(6384),I=a(7410),L=a(9150),q=a(4436),R=a(3999),Q=a(124),K=a(3796),W=a(386),N=a(5173),D=a(492),T=a(3952),E=a(330),$=a(6056),P=a(8958),S=a(5205),V=a(2156),X=a(3316),B=a(8670),z=a(3676),U=a(4189),G=a(9270),j=a(2669),O=a(8672),M=a(9626),H=a(8582),Y=a.n(H);const J=(0,F.A)(y,[["render",r]]),Z=J;Y()(y,"components",{QLayout:A.A,QHeader:w.A,QToolbar:C.A,QBtn:x.A,QTooltip:I.A,QToolbarTitle:L.A,QMenu:q.A,QList:R.A,QItem:Q.A,QItemLabel:K.A,QSeparator:W.A,QItemSection:N.A,QIcon:D.A,QAvatar:T.A,QImg:E.A,QDrawer:$.A,QScrollArea:P.A,QPageContainer:S.A,QDialog:V.A,QCard:X.A,QBar:B.A,QSpace:z.A,QCardSection:U.A,QInput:G.A,QCardActions:j.A}),Y()(y,"directives",{ClosePopup:O.A,Ripple:M.A})}}]);