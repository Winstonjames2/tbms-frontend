"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[961],{1961:(e,o,t)=>{t.r(o),t.d(o,{default:()=>de});var l=t(1758),a=t(6683),n=t(2901);const s={class:"page-wrap custom-scrollbar-color"},i={class:"col-12"},r={class:"text-h5 text-primary"},d={class:"col-12 col-md-4"},u={class:"field-label"},c={class:"col-12 col-md-4"},p={class:"field-label"},m={class:"col-12 col-md-4"},v={class:"field-label"},g={class:"row items-center justify-end q-gutter-sm q-pa-sm"},b={class:"q-mt-md"},_={class:"col-12 col-md-6"},f={class:"text-body2"},y={class:"text-grey-8"},w={class:"col-12 col-md-6"},k={class:"text-body1 text-grey-7"},F={class:"text-h6 text-primary text-weight-bold"},h={class:"text-body2 text-grey-7"},C={class:"text-subtitle2 text-weight-medium"},q={class:"sticky-actions q-pa-sm"},x={class:"text-h6"};function V(e,o,t,V,A,R){const S=(0,l.g2)("q-icon"),L=(0,l.g2)("q-item-section"),Q=(0,l.g2)("q-item"),$=(0,l.g2)("q-select"),I=(0,l.g2)("q-btn"),U=(0,l.g2)("q-date"),K=(0,l.g2)("q-popup-proxy"),N=(0,l.g2)("q-input"),P=(0,l.g2)("q-card-section"),D=(0,l.g2)("q-card"),W=(0,l.g2)("q-th"),T=(0,l.g2)("q-tr"),G=(0,l.g2)("q-td"),O=(0,l.g2)("q-tooltip"),E=(0,l.g2)("q-table"),M=(0,l.g2)("q-separator"),B=(0,l.g2)("q-banner"),H=(0,l.g2)("q-avatar"),j=(0,l.g2)("q-card-actions"),z=(0,l.g2)("q-dialog"),X=(0,l.g2)("q-page"),J=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(X,{class:"page-container"},{default:(0,l.k6)((()=>[(0,l.bF)(a.eB,{appear:"","enter-active-class":"animated fadeIn"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",s,[(0,l.bF)(D,{class:"card header-card"},{default:(0,l.k6)((()=>[(0,l.bF)(P,{class:"row q-col-gutter-md items-end"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",i,[(0,l.Lk)("div",r,(0,n.v_)(e.$t("receivegoods.title")),1)]),(0,l.Lk)("div",d,[(0,l.Lk)("div",u,(0,n.v_)(e.$t("receivegoods.view_receivegoods.customer")),1),(0,l.bF)($,{dense:"",filled:"",clearable:"",modelValue:V.selectedCustomer,"onUpdate:modelValue":o[0]||(o[0]=e=>V.selectedCustomer=e),options:V.customerFilteredOptions,onFilter:V.onCustomerFilter,"input-debounce":"0","use-input":V.customerUseInput,behavior:"menu","emit-value":"","map-options":"","option-label":e=>e?.label??"","option-value":e=>e?.value??null,loading:V.loading,disable:V.loading,error:V.customerError,"error-message":e.$t("error.input.enterValue"),hint:"Start typing to search",class:"input-field",onPopupHide:V.onCustomerSelected,onPopupShow:V.onCustomerPopupShow,onClear:V.onCustomerCleared},{prepend:(0,l.k6)((()=>[(0,l.bF)(S,{name:"sym_r_people"})])),"no-option":(0,l.k6)((()=>[(0,l.bF)(Q,null,{default:(0,l.k6)((()=>[(0,l.bF)(L,{class:"text-grey"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.$t("noResults")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","use-input","option-label","option-value","loading","disable","error","error-message","onPopupHide","onPopupShow","onClear"])]),(0,l.Lk)("div",c,[(0,l.Lk)("div",p,(0,n.v_)(e.$t("receivegoods.view_receivegoods.company")),1),(0,l.bF)($,{dense:"",filled:"",clearable:"",modelValue:V.selectedCompany,"onUpdate:modelValue":o[1]||(o[1]=e=>V.selectedCompany=e),options:V.companyFilteredOptions,onFilter:V.onCompanyFilter,"input-debounce":"0","use-input":V.companyUseInput,behavior:"menu","emit-value":"","map-options":"","option-label":e=>e?.label??"","option-value":e=>e?.value??null,loading:V.loading,disable:V.loading,error:V.customerError,"error-message":e.$t("error.input.enterValue"),hint:"Start typing to search",class:"input-field",maxlength:"50",onPopupHide:V.onCompanySelected,onPopupShow:V.onCompanyPopupShow,onClear:V.onCompanyCleared},{prepend:(0,l.k6)((()=>[(0,l.bF)(S,{name:"sym_r_business"})])),"no-option":(0,l.k6)((()=>[(0,l.bF)(Q,null,{default:(0,l.k6)((()=>[(0,l.bF)(L,{class:"text-grey"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.$t("noResults")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","use-input","option-label","option-value","loading","disable","error","error-message","onPopupHide","onPopupShow","onClear"])]),(0,l.Lk)("div",m,[(0,l.Lk)("div",v,(0,n.v_)(e.$t("receivegoods.date")),1),(0,l.bF)(N,{dense:"",filled:"",modelValue:V.date,"onUpdate:modelValue":o[3]||(o[3]=e=>V.date=e),mask:"date",rules:["date"],class:"input-field"},{append:(0,l.k6)((()=>[(0,l.bF)(S,{name:"sym_r_event",color:"primary",class:"cursor-pointer"},{default:(0,l.k6)((()=>[(0,l.bF)(K,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)((()=>[(0,l.bF)(U,{modelValue:V.date,"onUpdate:modelValue":o[2]||(o[2]=e=>V.date=e)},{default:(0,l.k6)((()=>[(0,l.Lk)("div",g,[(0,l.bo)((0,l.bF)(I,{flat:"",color:"primary",label:"Close"},null,512),[[J]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),_:1})])),_:1}),(0,l.bF)(D,{class:"card"},{default:(0,l.k6)((()=>[(0,l.bF)(P,null,{default:(0,l.k6)((()=>[(0,l.bF)(E,{rows:V.rows,columns:V.columns,"row-key":"__rowId",flat:"",dense:"","hide-bottom":"",separator:"cell",class:"rg-table","rows-per-page-options":[0]},{header:(0,l.k6)((e=>[(0,l.bF)(T,{props:e},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.cols,(o=>((0,l.uX)(),(0,l.Wv)(W,{key:o.name,props:e,style:{"font-size":"1rem","font-weight":"bold"},class:"text-h5"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(o.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,l.k6)((o=>[(0,l.bF)(T,{props:o,class:"row-hover"},{default:(0,l.k6)((()=>[(0,l.bF)(G,{key:"goods",props:o},{default:(0,l.k6)((()=>[(0,l.bF)($,{dense:"",filled:"",modelValue:o.row.name,"onUpdate:modelValue":[e=>o.row.name=e,e=>V.onGoodsModelUpdate(e,o.row)],options:V.goodsFilteredOptions,onFilter:(e,t)=>V.onGoodsFilter(e,t,o.row),"use-input":"","input-debounce":"0",behavior:"menu","option-label":e=>e?.label??"","option-value":e=>e??null,onInputValue:()=>V.onGoodsSelected(o.row),onClear:()=>V.onGoodsCleared(o.row),clearable:""},{"no-option":(0,l.k6)((()=>[(0,l.bF)(Q,null,{default:(0,l.k6)((()=>[(0,l.bF)(L,{class:"text-grey"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.$t("noResults")),1)])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","options","onFilter","option-label","option-value","onInputValue","onClear"])])),_:2},1032,["props"]),(0,l.bF)(G,{key:"quantity",props:o},{default:(0,l.k6)((()=>[(0,l.bF)(N,{dense:"",filled:"",modelValue:o.row.quantity,"onUpdate:modelValue":[e=>o.row.quantity=e,e=>V.onQuantityChange(e,o.row)],modelModifiers:{number:!0},type:"number",min:"0","input-class":"text-left",m:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"]),(0,l.bF)(G,{key:"goods_rate",props:o},{default:(0,l.k6)((()=>[(0,l.bF)(N,{dense:"",filled:"",modelValue:o.row.goods_rate,"onUpdate:modelValue":e=>o.row.goods_rate=e,modelModifiers:{number:!0},type:"number",readonly:"","input-class":"text-right"},{prepend:(0,l.k6)((()=>[(0,l.bF)(S,{name:"sym_r_payments"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"]),(0,l.bF)(G,{key:"goods_total",props:o},{default:(0,l.k6)((()=>[(0,l.bF)(N,{dense:"",filled:"",modelValue:o.row.goods_total,"onUpdate:modelValue":e=>o.row.goods_total=e,modelModifiers:{number:!0},type:"number",readonly:"","input-class":"text-right"},{prepend:(0,l.k6)((()=>[(0,l.bF)(S,{name:"sym_r_calculate"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"]),(0,l.bF)(G,{key:"actions",props:o,class:"text-center"},{default:(0,l.k6)((()=>[(0,l.bF)(I,{round:"",dense:"",flat:"",color:"negative",icon:"sym_r_delete",onClick:e=>V.deleteRow(o.rowIndex)},{default:(0,l.k6)((()=>[(0,l.bF)(O,(0,n._B)((0,l.Ng)(V.tooltip)),{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.$t("index.removeRow")),1)])),_:1},16)])),_:2},1032,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["rows","columns"]),(0,l.Lk)("div",b,[(0,l.bF)(I,{outline:"",rounded:"",color:"positive",icon:"sym_r_add",label:e.$t("receivegoods.view_receivegoods.addRow"),class:"text-capitalize",onClick:V.addRow},null,8,["label","onClick"])])])),_:1}),(0,l.bF)(M,{spaced:""}),(0,l.bF)(P,{class:"row q-col-gutter-md items-stretch"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",_,[(0,l.bF)(B,{rounded:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",f,[(0,l.eW)((0,n.v_)(e.$t("tips")||"Tips")+": ",1),(0,l.Lk)("span",y,(0,n.v_)(e.$t("receivegoods.view_receivegoods.tipMessage")),1)])])),_:1})]),(0,l.Lk)("div",w,[(0,l.bF)(D,{flat:"",bordered:"",class:"totals-card"},{default:(0,l.k6)((()=>[(0,l.bF)(P,{class:"row items-center justify-between"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",k,(0,n.v_)(e.$t("receivegoods.view_receivegoods.grandTotalAmount")),1),(0,l.Lk)("div",F,(0,n.v_)(V.formatNumber(V.supertotal)),1)])),_:1}),(0,l.bF)(M),(0,l.bF)(P,{class:"row items-center justify-between"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",h,(0,n.v_)(e.$t("receivegoods.view_receivegoods.grandTotalWeight")),1),(0,l.Lk)("div",C,(0,n.v_)(V.formatNumber(V.totalWeight)),1)])),_:1})])),_:1})])])),_:1})])),_:1}),(0,l.Lk)("div",q,[(0,l.bF)(I,{color:"primary",unelevated:"",icon:"sym_r_save",label:e.$t("receivegoods.view_receivegoods.save"),class:"action-btn",onClick:V.tryOpenSubmitDialog,disable:!V.canSubmit||V.loading},null,8,["label","onClick","disable"])]),(0,l.bF)(z,{modelValue:V.submitDialog,"onUpdate:modelValue":o[4]||(o[4]=e=>V.submitDialog=e),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(D,{style:{"min-width":"360px","max-width":"92vw"}},{default:(0,l.k6)((()=>[(0,l.bF)(P,{class:"row items-center q-gutter-sm"},{default:(0,l.k6)((()=>[(0,l.bF)(H,{icon:"sym_r_check",color:"primary","text-color":"white"}),(0,l.Lk)("div",x,(0,n.v_)(e.$t("receivegoods.view_receivegoods.confirmSave")),1)])),_:1}),(0,l.bF)(M),(0,l.bF)(P,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.$t("receivegoods.view_receivegoods.confirmSaveContent")),1)])),_:1}),(0,l.bF)(j,{align:"right",class:"q-pa-md"},{default:(0,l.k6)((()=>[(0,l.bo)((0,l.bF)(I,{flat:"",label:e.$t("receivegoods.view_receivegoods.cancel"),color:"negative",icon:"sym_r_close"},null,8,["label"]),[[J]]),(0,l.bF)(I,{color:"primary",label:e.$t("receivegoods.view_receivegoods.ok"),icon:"sym_r_check",onClick:V.submitData},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),_:1})])),_:1})}t(310),t(5962),t(6724),t(2802);var A=t(555),R=t(3537),S=t(4907),L=t(1271),Q=t(2261),$=t(7144);let I=0;const U=()=>({__rowId:`row-${Date.now()}-${I++}`,name:null,quantity:null,goods_rate:0,goods_weight:0,goods_total:0}),K={name:"ReceiveGoodsPage",setup(){const{t:e}=(0,R.s9)(),o=(0,S.A)(),t=(0,A.KR)(!1),a=(0,A.KR)(!1),n=(0,A.KR)((new Date).toISOString().split("T")[0].replace(/-/g,"/")),s=(0,A.KR)(null),i=(0,A.KR)(null),r=(0,A.KR)([]),d=(0,A.KR)([]),u=(0,A.KR)([]),c=(0,A.KR)([]),p=(0,A.KR)([]),m=(0,A.KR)([]),v=(0,A.KR)(!0),g=(0,A.KR)(!0),b=(0,A.KR)([U(),U(),U(),U()]),_=(0,A.KR)(0),f=(0,A.KR)(0),y=[{name:"goods",label:e("receivegoods.view_receivegoods.particular"),field:"name",align:"left"},{name:"quantity",label:e("receivegoods.view_receivegoods.quantity"),field:"quantity",align:"left",style:"max-width: 150px; min-width: 140px;"},{name:"goods_rate",label:e("receivegoods.view_receivegoods.rate"),field:"goods_rate",align:"right",style:"max-width: 150px; min-width: 140px;"},{name:"goods_total",label:e("receivegoods.view_receivegoods.total"),field:"goods_total",align:"right",style:"max-width: 150px; min-width: 140px;"},{name:"actions",label:e("receivegoods.view_receivegoods.delete"),field:"__actions",align:"center"}],w=(e,o)=>(t,l)=>{const a=(t||"").toString().toLowerCase();l((()=>{o.value=a?e.value.filter((e=>e.label.toLowerCase().includes(a))):e.value}))},k=w(r,c),F=w(d,p),h=w(u,m);function C(e,o){v.value=!0,k(e,o)}function q(e,o){g.value=!0,F(e,o)}function x(e,o,t){h(e,o)}const V=()=>{_.value=b.value.reduce(((e,o)=>e+(Number(o.goods_total)||0)),0),f.value=b.value.reduce(((e,o)=>{const t=Number(o.name?.goods_weight)||0,l=Number(o.quantity);return e+t*l}),0)};function I(e){if(null===e||void 0===e||""===e)return null;const o=Number(e);return Number.isNaN(o)?null:o}const K=e=>{e.goods_rate=e?.name?Math.floor(Number(e.name.goods_rate)||0):0;const o=I(e.quantity);e.quantity=null===o?null:o,e.goods_total=(Number(e.goods_rate)||0)*(o||0),V()};function N(e,o){o.name=e,K(o)}function P(e){K(e)}function D(e){e.name=null,K(e)}function W(e,o){o.quantity=I(e),K(o)}function T(){v.value=!0}function G(){v.value=!1}function O(){v.value=!0,s.value=null}function E(){g.value=!0}function M(){g.value=!1}function B(){i.value=null,g.value=!0}const H=()=>{console.log(b.value),b.value.push(U())},j=e=>{b.value.splice(e,1),V()},z=(0,l.EW)((()=>b.value.filter((e=>e.name&&Number(e.quantity)>0)))),X=(0,l.EW)((()=>!!s.value&&z.value.length>0)),J=(0,A.KR)(!1),Y=(0,l.EW)((()=>!s.value&&J.value)),Z=()=>{J.value=!0,X.value?a.value=!0:o.notify({type:"warning",message:e("error.fillRequired")})},ee=async()=>{try{t.value=!0;const e={ConsignmentData:{received_date:n.value.replace(/\//g,"-"),customer:s.value,company:i.value,total_amount:_.value,total_weight:f.value},receiveGoodsData:z.value.map((e=>({goods:e.name.value,quantity:e.quantity})))},l=await(0,Q.postauth)("consignment/",e);if("200"!==l.code)return void o.notify({color:"negative",icon:"sym_r_close",message:"Failed Registering Data!"});o.notify({color:"positive",icon:"sym_r_check",message:"Successfully Created"})}catch(e){oe(),o.notify({color:"negative",icon:"sym_r_close",message:"Failed Registering Data! "+e})}finally{t.value=!1,a.value=!1}},oe=()=>{b.value=[U(),U(),U(),U()],s.value=null,i.value=null,_.value=0,f.value=0,J.value=!1,v.value=!0,g.value=!0},te=async()=>{L.A.has("customer")||await(0,$.e7)("customer"),L.A.has("company")||await(0,$.e7)("company"),L.A.has("goods")||await(0,$.e7)("goods"),r.value=(L.A.getItem("customer")||[]).map((e=>({label:e.name,value:e.id}))),d.value=(L.A.getItem("company")||[]).map((e=>({label:e.name,value:e.id}))),u.value=(L.A.getItem("goods")||[]).map((e=>({label:e.name,value:e.id,goods_rate:e.goods_rate,goods_weight:e.goods_weight}))),c.value=r.value,p.value=d.value,m.value=u.value};(0,l.sV)(te);const le=e=>(new Intl.NumberFormat).format(Number(e||0)),ae={class:"bg-blue text-white shadow-4",offset:[10,10],contentStyle:"font-size: 12px"};return{t:e,tooltip:ae,loading:t,submitDialog:a,date:n,selectedCustomer:s,selectedCompany:i,customerFilteredOptions:c,companyFilteredOptions:p,goodsFilteredOptions:m,customerUseInput:v,companyUseInput:g,rows:b,columns:y,addRow:H,deleteRow:j,onRowChange:K,onCustomerFilter:C,onCompanyFilter:q,onGoodsFilter:x,onGoodsSelected:P,onGoodsCleared:D,onGoodsModelUpdate:N,onQuantityChange:W,onCustomerSelected:G,onCustomerCleared:O,onCustomerPopupShow:T,onCompanySelected:M,onCompanyCleared:B,onCompanyPopupShow:E,supertotal:_,totalWeight:f,canSubmit:X,tryOpenSubmitDialog:Z,submitData:ee,formatNumber:le,customerError:Y}}};var N=t(2807),P=t(7716),D=t(3316),W=t(4189),T=t(4940),G=t(492),O=t(124),E=t(5173),M=t(9270),B=t(1356),H=t(8462),j=t(6384),z=t(6653),X=t(4488),J=t(7722),Y=t(5262),Z=t(7410),ee=t(386),oe=t(6868),te=t(2156),le=t(3952),ae=t(2669),ne=t(8672),se=t(8582),ie=t.n(se);const re=(0,N.A)(K,[["render",V]]),de=re;ie()(K,"components",{QPage:P.A,QCard:D.A,QCardSection:W.A,QSelect:T.A,QIcon:G.A,QItem:O.A,QItemSection:E.A,QInput:M.A,QPopupProxy:B.A,QDate:H.A,QBtn:j.A,QTable:z.A,QTr:X.A,QTh:J.A,QTd:Y.A,QTooltip:Z.A,QSeparator:ee.A,QBanner:oe.A,QDialog:te.A,QAvatar:le.A,QCardActions:ae.A}),ie()(K,"directives",{ClosePopup:ne.A})}}]);