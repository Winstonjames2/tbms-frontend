"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[280],{6639:(e,l,a)=>{a.r(l),a.d(l,{default:()=>L});a(310),a(5962);var t=a(1758),o=a(6683),i=a(2901);const n={class:"q-mt-md"},r={class:"q-pa-sm flex flex-center"},d={class:"q-pa-sm flex flex-center"};function s(e,l,a,s,u,c){const m=(0,t.g2)("q-tooltip"),g=(0,t.g2)("q-btn"),p=(0,t.g2)("q-btn-group"),b=(0,t.g2)("q-space"),f=(0,t.g2)("q-icon"),w=(0,t.g2)("q-input"),h=(0,t.g2)("q-td"),v=(0,t.g2)("EditableCell"),_=(0,t.g2)("q-tr"),y=(0,t.g2)("q-table"),F=(0,t.g2)("q-pagination"),k=(0,t.g2)("q-bar"),V=(0,t.g2)("q-select"),x=(0,t.g2)("q-card-section"),C=(0,t.g2)("q-card-actions"),D=(0,t.g2)("q-card"),A=(0,t.g2)("q-dialog"),q=(0,t.g2)("view-dialog"),K=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.bF)(o.eB,{appear:"","enter-active-class":"animated fadeIn"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{separator:"cell",class:"my-sticky-header-column-table shadow-24",rows:s.paginatedRows,"row-key":"id",loading:s.loading,filter:s.filter,columns:s.columns,"hide-bottom":"",pagination:s.pagination,"onUpdate:pagination":l[6]||(l[6]=e=>s.pagination=e),paginationModifiers:{sync:!0},"no-data-label":"No data","no-results-label":"No data you want",style:{height:"calc(100vh - 190px)"},flat:"",bordered:""},{top:(0,t.k6)((()=>[(0,t.bF)(p,{push:""},{default:(0,t.k6)((()=>[(0,t.bF)(g,{label:e.$t("new"),icon:"sym_r_add",onClick:l[0]||(l[0]=e=>s.newForm=!0)},{default:(0,t.k6)((()=>[(0,t.bF)(m,(0,i._B)((0,t.Ng)(s.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.$t("newtip")),1)])),_:1},16)])),_:1},8,["label"]),(0,t.bF)(g,{label:e.$t("refresh"),icon:"sym_r_refresh",onClick:l[1]||(l[1]=e=>s.fetchTableData())},{default:(0,t.k6)((()=>[(0,t.bF)(m,(0,i._B)((0,t.Ng)(s.tooltip)),{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.$t("refreshtip")),1)])),_:1},16)])),_:1},8,["label"])])),_:1}),(0,t.bF)(b),(0,t.bF)(w,{outlined:"",rounded:"",dense:"",debounce:"300",color:"primary",modelValue:s.filter,"onUpdate:modelValue":l[3]||(l[3]=e=>s.filter=e),placeholder:e.$t("search"),onInput:l[4]||(l[4]=e=>s.getSearchList()),onKeyup:l[5]||(l[5]=(0,o.jR)((e=>s.getSearchList()),["enter"]))},{append:(0,t.k6)((()=>[(0,t.bF)(f,{name:"sym_r_search",onClick:l[2]||(l[2]=e=>s.getSearchList())})])),_:1},8,["modelValue","placeholder"])])),body:(0,t.k6)((e=>[(0,t.bF)(_,{props:e},{default:(0,t.k6)((()=>[(0,t.bF)(h,{key:"code",props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.row.code),1)])),_:2},1032,["props"]),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.editableColumns,(l=>((0,t.uX)(),(0,t.Wv)(v,{key:l.field,row:e.row,field:l.field,label:l.label,rules:l.rules,mask:l.mask,"edit-id":s.editId,"model-value":e.row.id===s.editId?s.editFormData[l.field]:e.row[l.field],translate:l.translate||!1,options:l.options||[],booleanField:l.booleanField||!1,"onUpdate:modelValue":e=>s.editFormData[l.field]=e,props:e},null,8,["row","field","label","rules","mask","edit-id","model-value","translate","options","booleanField","onUpdate:modelValue","props"])))),128)),(0,t.bF)(h,{key:"creator",props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.row.creator),1)])),_:2},1032,["props"]),(0,t.bF)(h,{key:"create_time",props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.row.create_time),1)])),_:2},1032,["props"]),(0,t.bF)(h,{key:"action",props:e,style:(0,i.Tr)([{width:"100px"},s.actionCellStyle(e)])},{default:(0,t.k6)((()=>[e.row.id!==s.editId?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:0},(0,t.pI)(s.rowActions,(l=>((0,t.uX)(),(0,t.Wv)(g,(0,t.v6)({key:l.icon,ref_for:!0},l,{onClick:a=>l.action(e.row)}),{default:(0,t.k6)((()=>[(0,t.bF)(m,(0,t.v6)({ref_for:!0},s.tooltip),{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(l.tip),1)])),_:2},1040)])),_:2},1040,["onClick"])))),128)):((0,t.uX)(!0),(0,t.CE)(t.FK,{key:1},(0,t.pI)(s.editActions,(e=>((0,t.uX)(),(0,t.Wv)(g,(0,t.v6)({key:e.icon,ref_for:!0},e,{onClick:e.action}),null,16,["onClick"])))),128))])),_:2},1032,["props","style"])])),_:2},1032,["props"])])),_:1},8,["rows","loading","filter","columns","pagination"])])),_:1}),(0,t.bo)((0,t.Lk)("div",r,[(0,t.bF)(F,{modelValue:s.current,"onUpdate:modelValue":[l[7]||(l[7]=e=>s.current=e),l[8]||(l[8]=e=>s.paginationIpt=e)],max:s.max,"max-pages":10,"boundary-links":"",color:"red-8"},null,8,["modelValue","max"]),(0,t.bF)(w,{modelValue:s.paginationIpt,"onUpdate:modelValue":l[9]||(l[9]=e=>s.paginationIpt=e),modelModifiers:{number:!0},outlined:"",round:"",dense:"",color:"red-8",onBlur:s.changePageEnter,onKeyup:(0,o.jR)(s.changePageEnter,["enter"]),style:{width:"50px"},class:"center"},null,8,["modelValue","onBlur","onKeyup"])],512),[[o.aG,s.max]]),(0,t.bo)((0,t.Lk)("div",d,[(0,t.bF)(g,{flat:"",push:"",color:"darkText",label:e.$t("no_data")},null,8,["label"])],512),[[o.aG,!s.max]]),(0,t.bF)(A,{modelValue:s.newForm,"onUpdate:modelValue":l[15]||(l[15]=e=>s.newForm=e),"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{class:"shadow-24 column no-wrap",style:{"max-height":"90vh","max-width":"400px",width:"90vw"}},{default:(0,t.k6)((()=>[(0,t.bF)(k,{class:"bg-primary text-white rounded-borders",style:{height:"50px"}},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.$t("goods.view_goods.create_goods"))+" ",1),(0,t.bF)(b),(0,t.bo)((0,t.bF)(g,{dense:"",flat:"",icon:"sym_r_close"},null,512),[[K]])])),_:1}),(0,t.bF)(x,{class:"scroll",style:{"overflow-y":"auto",flex:"1"}},{default:(0,t.k6)((()=>[(0,t.bF)(w,{dense:"",outlined:"",modelValue:s.newFormData.name,"onUpdate:modelValue":l[10]||(l[10]=e=>s.newFormData.name=e),label:e.$t("goods.view_goodstype.name"),rules:[s.validate.required],maxlength:"255",autofocus:""},null,8,["modelValue","label","rules"]),(0,t.bF)(w,{dense:"",outlined:"",modelValue:s.newFormData.description,"onUpdate:modelValue":l[11]||(l[11]=e=>s.newFormData.description=e),label:e.$t("goods.view_goodstype.description"),rules:[null],maxlength:"255",type:"textarea"},null,8,["modelValue","label"]),(0,t.bF)(w,{dense:"",outlined:"",modelValue:s.newFormData.weight_limit,"onUpdate:modelValue":l[12]||(l[12]=e=>s.newFormData.weight_limit=e),modelModifiers:{number:!0},type:"number",label:e.$t("goods.view_goodstype.weight_limit"),rules:[s.validate.intValue],maxlength:"10"},null,8,["modelValue","label","rules"]),(0,t.bF)(w,{dense:"",outlined:"",modelValue:s.newFormData.dimensions,"onUpdate:modelValue":l[13]||(l[13]=e=>s.newFormData.dimensions=e),label:e.$t("goods.view_goodstype.dimensions"),rules:[s.validate.dimension],hint:s.t("tip.lxwxh"),maxlength:"50"},null,8,["modelValue","label","rules","hint"]),(0,t.bF)(V,{dense:"",outlined:"",modelValue:s.newFormData.fragile,"onUpdate:modelValue":l[14]||(l[14]=e=>s.newFormData.fragile=e),options:s.fragileOptions,"transition-show":"scale","transition-hide":"scale",label:e.$t("goods.view_goodstype.fragile"),rules:[s.validate.required]},null,8,["modelValue","options","label","rules"])])),_:1}),(0,t.bF)(C,{align:"right"},{default:(0,t.k6)((()=>[(0,t.bo)((0,t.bF)(g,{flat:"",label:s.t("cancel"),onClick:s.resetNewForm},null,8,["label","onClick"]),[[K]]),(0,t.bF)(g,{color:"primary",label:s.t("submit"),disable:!s.isNewFormValid,onClick:s.newDataSubmit},null,8,["label","disable","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(q,{modelValue:s.viewDialog,"onUpdate:modelValue":l[16]||(l[16]=e=>s.viewDialog=e),data:s.viewDataForm,title:e.$t("goods.view_goodstype.view_goodstype_tip"),goodstype:"type"},null,8,["modelValue","data","title"]),(0,t.bF)(A,{modelValue:s.deleteForm,"onUpdate:modelValue":l[17]||(l[17]=e=>s.deleteForm=e)},{default:(0,t.k6)((()=>[(0,t.bF)(D,{class:"shadow-24",style:{"max-width":"350px",width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(k,{style:{height:"50px"},class:"bg-primary text-white"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.$t("delete"))+" ",1),(0,t.bF)(b),(0,t.bo)(((0,t.uX)(),(0,t.Wv)(g,{dense:"",flat:"",icon:"sym_r_close"},{default:(0,t.k6)((()=>[(0,t.bF)(m,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.$t("index.close")),1)])),_:1})])),_:1})),[[K]])])),_:1}),(0,t.bF)(x,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.$t("deletetip")),1)])),_:1}),(0,t.bF)(C,{align:"right"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{flat:"",label:s.t("cancel"),onClick:s.resetDelete},null,8,["label","onClick"]),(0,t.bF)(g,{color:"primary",label:s.t("delete"),onClick:s.deleteDataSubmit},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}a(95),a(6724),a(9240);var u=a(2261),c=a(1271),m=a(4907),g=a(7144),p=a(555),b=a(3537),f=a(6396),w=a(5677);const h={name:"PageGoodsTypeList",components:{EditableCell:w.A,ViewDialog:f.A},setup(){const{t:e}=(0,b.s9)(),l=(0,m.A)(),a="goodstype",o=(0,p.KR)(!1),i=(0,p.KR)(c.A.getItem("userRole")),n=(0,p.KR)(c.A.getItem(a)||[]),r=(0,p.KR)(""),d=(0,p.KR)(1),s=(0,p.KR)(25),f=(0,p.KR)({page:1,rowsPerPage:s.value}),w=(0,p.KR)(1),h=(0,p.KR)(!1),v=(0,p.Kh)({}),_=(0,t.EW)((()=>{if(!r.value)return n.value;const e=r.value.toLowerCase();return n.value.filter((l=>Object.values(l).some((l=>l?.toString().toLowerCase().includes(e)))))})),y=(0,t.EW)((()=>{const e=(d.value-1)*s.value;return _.value.slice(e,e+s.value)})),F=(0,t.EW)((()=>Math.ceil(_.value.length/s.value))),k=(0,p.KR)(!1),V=(0,p.Kh)({name:"",weight_limit:"",dimensions:"",fragile:"",description:""}),x=(0,p.Kh)({}),C=(0,p.KR)(0),D=(0,p.KR)(!1),A=(0,p.Kh)({}),q=(0,p.KR)(!1),K=(0,p.KR)(0),E={class:"bg-blue text-white shadow-4",offset:[10,10],contentStyle:"font-size: 12px"},I=[{label:e("index.yes"),value:!0},{label:e("index.no"),value:!1}],$={required:l=>!!l||e("error.input.enterValue"),intValue:l=>l>0||e("error.input.enterNumber"),dimension:l=>{if(!l)return e("error.input.enterValue");const a=/^\d+\s*x\s*\d+\s*x\s*\d+$/;return a.test(l)||e("error.input.dimensionFormat")},boolean:l=>"boolean"===typeof l||e("error.input.enterBoolean")},R=(0,t.EW)((()=>!0===$.required(A.name)&&!0===$.intValue(A.weight_limit)&&!0===$.dimension(A.dimensions)&&!0===$.boolean(A.fragile))),S=(0,t.EW)((()=>!0===$.required(V.name)&&!0===$.intValue(V.weight_limit)&&!0===$.dimension(V.dimensions)&&!0===$.required(V.fragile))),W=()=>{const e=Math.min(Math.max(Number(w.value),1),F.value||1);d.value=w.value=e},Q=()=>{n.value=c.A.getItem(a)||[],d.value=w.value=1},U=async()=>{o.value=!0,T(),await(0,g.e7)(a),n.value=c.A.getItem(a)||[],o.value=!1},j=async()=>{if(l.loading.show(),!S.value)return l.notify({message:e("error.data_invalid"),icon:"sym_r_close",color:"negative"}),void l.loading.hide();try{const t={...V};t.fragile=t.fragile.value;const o=await(0,u.postauth)(a+"/",t);if(console.log(o),"200"!==o.code)throw new Error;await U(),L(),l.notify({message:e("successful.create"),color:"green"})}catch(a){l.notify({message:e("error.create"),color:"negative"})}finally{l.loading.hide()}},L=()=>{Object.keys(V).forEach((e=>{V[e]=null})),k.value=!1},N=e=>{D.value=!0,C.value=e.id,Object.assign(A,e),Object.assign(x,e)},O=async()=>{if(!R.value)return void l.notify({message:e("error.data_invalid"),icon:"sym_r_close",color:"negative"});const t=Object.fromEntries(Object.entries(A).filter((([e,l])=>l!==x[e])));if(!Object.keys(t).length)return l.notify({message:e("error.no_changes"),color:"warning"});try{l.loading.show();const o=await(0,u.patchauth)(`${a}/${C.value}/`,t);if(console.log(o),"200"!==o.code)throw new Error;T(),await U(),l.notify({message:e("successful.update"),color:"green"})}catch(a){l.notify({message:e("error.update"),color:"negative"})}finally{l.loading.hide()}},T=()=>{D.value=!1,C.value=0,Object.keys(A).forEach((e=>delete A[e]))},B=e=>{h.value=!0,Object.assign(v,e),delete v.id,delete v.update_time},P=e=>{q.value=!0,K.value=e},X=async()=>{l.loading.show();try{const t=await(0,u.deleteauth)(`${a}/${K.value}/`);if(T(),"200"!==t.code)throw new Error;l.notify({message:e("successful.delete"),color:"green"}),await(0,g.e7)(a),n.value=c.A.getItem(a)}catch{l.notify({message:e("error.delete"),color:"negative"})}finally{l.loading.hide()}},M=e=>D.value&&e.row.id===C.value?{backgroundColor:"#cbc6d2"}:{},z=[{round:!0,flat:!0,push:!0,color:"green",icon:"sym_r_check",action:O},{round:!0,flat:!0,push:!0,color:"red",icon:"sym_r_close",action:T}],G=(0,p.Kh)([{field:"name",label:e("goods.view_goodstype.name"),rules:[$.required],truncate:!1},{field:"description",label:e("goods.view_goodstype.description"),rules:[null],truncate:!0,truncateLength:40},{field:"weight_limit",label:e("goods.view_goodstype.weight_limit"),rules:[$.intValue],truncate:!1},{field:"dimensions",label:e("goods.view_goodstype.dimensions"),rules:[$.dimension],truncate:!1},{field:"fragile",label:e("goods.view_goodstype.fragile"),rules:[$.required],truncate:!1,options:I,translate:!0,booleanField:!0}]),H=[{round:!0,flat:!0,push:!0,color:"amber-2",icon:"sym_r_visibility",tip:e("index.view_detail"),action:B},{round:!0,flat:!0,push:!0,color:"amber-4",icon:"sym_r_edit",tip:e("edit"),action:N},{round:!0,flat:!0,push:!0,color:"amber-13",icon:"sym_r_delete",tip:e("delete"),action:e=>P(e.id)}],J=l=>{const a=[{name:"code",label:e("goods.view_goodstype.code"),field:"code",align:"center"},{name:"name",label:e("goods.view_goodstype.name"),field:"name",align:"left"},{name:"description",label:e("goods.view_goodstype.description"),field:"description",align:"left"},{name:"weight_limit",label:e("goods.view_goodstype.weight_limit"),field:"weight_limit",align:"left"},{name:"dimensions",label:e("goods.view_goodstype.dimensions"),field:"dimensions",align:"left"},{name:"fragile",label:e("goods.view_goodstype.fragile"),field:"fragile",align:"left"}],t=[{name:"creator",label:e("creator"),field:"creator",align:"left"},{name:"create_time",label:e("createtime"),field:"create_time",align:"left"}],o={name:"action",label:e("action"),align:"left"};return[...a.map((e=>({...e,headerStyle:"font-weight: bold; font-size: 13px"}))),..."Admin"===l?t.map((e=>({...e,headerStyle:"font-weight: bold; font-size: 13px"}))):[],{...o,headerStyle:"font-weight: bold; font-size: 13px"}]},Y=(0,p.Kh)(J(i.value));return(0,t.sV)((()=>{n.value.length||U()})),{pathname:a,loading:o,tableList:n,columns:Y,filter:r,pagination:f,newForm:k,newFormData:V,editId:C,editFormData:A,editMode:D,deleteForm:q,deleteId:K,current:d,max:F,paginationIpt:w,changePageEnter:W,getSearchList:Q,fetchTableData:U,newDataSubmit:j,resetNewForm:L,editData:N,editDataSubmit:O,resetDelete:T,deleteData:P,deleteDataSubmit:X,t:e,q:l,fragileOptions:I,validate:$,isEditFormValid:R,isNewFormValid:S,paginatedRows:y,actionCellStyle:M,viewData:B,viewDialog:h,viewDataForm:v,editActions:z,editableColumns:G,rowActions:H,tooltip:E}}};var v=a(2807),_=a(6653),y=a(6031),F=a(6384),k=a(7410),V=a(3676),x=a(9270),C=a(492),D=a(4488),A=a(5262),q=a(4700),K=a(2156),E=a(3316),I=a(8670),$=a(4189),R=a(4940),S=a(2669),W=a(8672),Q=a(8582),U=a.n(Q);const j=(0,v.A)(h,[["render",s]]),L=j;U()(h,"components",{QTable:_.A,QBtnGroup:y.A,QBtn:F.A,QTooltip:k.A,QSpace:V.A,QInput:x.A,QIcon:C.A,QTr:D.A,QTd:A.A,QPagination:q.A,QDialog:K.A,QCard:E.A,QBar:I.A,QCardSection:$.A,QSelect:R.A,QCardActions:S.A}),U()(h,"directives",{ClosePopup:W.A})}}]);