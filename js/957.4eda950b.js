"use strict";(globalThis["webpackChunktbls"]=globalThis["webpackChunktbls"]||[]).push([[957],{5957:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var s=a(1758),l=a(2901);const o={class:"q-mt-sm dashboard-container"},n={class:"left-column"},c={class:"q-gutter-x-sm q-ml-auto"},r={class:"q-gutter-x-sm q-ml-auto"},i={class:"right-column"};function d(e,t,a,d,u,p){const _=(0,s.g2)("q-icon"),b=(0,s.g2)("q-tooltip"),g=(0,s.g2)("q-btn"),m=(0,s.g2)("q-card-section"),k=(0,s.g2)("q-separator"),h=(0,s.g2)("q-item-section"),f=(0,s.g2)("q-badge"),A=(0,s.g2)("q-item"),F=(0,s.g2)("q-list"),q=(0,s.g2)("q-card"),y=(0,s.g2)("q-table"),v=(0,s.g2)("q-space"),w=(0,s.g2)("q-bar"),C=(0,s.g2)("q-td"),x=(0,s.g2)("q-dialog"),D=(0,s.g2)("UserManagement");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("div",n,[(0,s.bF)(q,{class:"glass-card custom-scrollbar-color"},{default:(0,s.k6)((()=>[(0,s.bF)(m,{class:"card-header q-pa-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(_,{name:"sym_r_local_shipping",class:"header-icon"}),t[3]||(t[3]=(0,s.Lk)("div",{class:"text-h6"},"Recent Truck Dispatch",-1)),(0,s.Lk)("div",c,[(0,s.bF)(g,{flat:"",icon:"sym_r_arrow_outward",class:"text-primary q-pa-xs q-ma-none",size:"md",onClick:d.openTruckDispatchPage},{default:(0,s.k6)((()=>[(0,s.bF)(b,(0,l._B)((0,s.Ng)(d.tooltip)),{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("dashboard.redirect_to_dispatch_page")),1)])),_:1},16)])),_:1},8,["onClick"])])])),_:1}),(0,s.bF)(k,{dark:""}),(0,s.bF)(m,{class:"scrollable-list"},{default:(0,s.k6)((()=>[(0,s.bF)(F,{separator:""},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.transports,(t=>((0,s.uX)(),(0,s.Wv)(A,{key:t.id},{default:(0,s.k6)((()=>[(0,s.bF)(h,{class:"list-item"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(t.code),1)])),_:2},1024),(0,s.bF)(h,{class:"list-item"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(t.dispatch_date),1)])),_:2},1024),(0,s.bF)(h,{class:"list-item"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(t.truck),1)])),_:2},1024),(0,s.bF)(h,null,{default:(0,s.k6)((()=>[(0,s.bF)(f,{color:d.getStatusColor(t.dispatch_status)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t(t.dispatch_status)),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),(0,s.bF)(q,{class:"glass-card custom-scrollbar-color"},{default:(0,s.k6)((()=>[(0,s.bF)(m,{class:"card-header q-pa-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(_,{name:"sym_r_history",class:"header-icon"}),t[4]||(t[4]=(0,s.Lk)("div",{class:"text-h6"},"Recent Actions",-1)),(0,s.Lk)("div",r,[(0,s.bF)(g,{flat:"",icon:"sym_r_open_in_full",class:"text-primary q-pa-xs q-ma-none",size:"sm",onClick:t[0]||(t[0]=e=>d.expandActionDialog=!0)},{default:(0,s.k6)((()=>[(0,s.bF)(b,(0,l._B)((0,s.Ng)(d.tooltip)),{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("index.expand_more")),1)])),_:1},16)])),_:1})])])),_:1}),(0,s.bF)(k),(0,s.bF)(m,{class:"recent-actions-table"},{default:(0,s.k6)((()=>[(0,s.bF)(y,{flat:"",dense:"",rows:d.recentActions,columns:d.columns,"row-key":"id","hide-bottom":"",pagination:{rowsPerPage:25},class:"custom-scrollbar-color",style:{"background-color":"transparent",overflow:"hidden"}},null,8,["rows","columns"])])),_:1})])),_:1}),(0,s.bF)(x,{modelValue:d.expandActionDialog,"onUpdate:modelValue":t[2]||(t[2]=e=>d.expandActionDialog=e),persistent:""},{default:(0,s.k6)((()=>[(0,s.bF)(q,{style:{width:"90vw",height:"90vh"},class:"q-pa-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(w,null,{default:(0,s.k6)((()=>[t[5]||(t[5]=(0,s.Lk)("div",{class:"text-subtitle2"},"All Recent Actions",-1)),(0,s.bF)(v),(0,s.bF)(g,{dense:"",flat:"",icon:"sym_r_close",onClick:t[1]||(t[1]=e=>d.expandActionDialog=!1)})])),_:1}),(0,s.bF)(k),(0,s.bF)(m,{class:"q-pa-none"},{default:(0,s.k6)((()=>[(0,s.bF)(y,{dense:"",flat:"",bordered:"",rows:d.recentActions,columns:d.dialogColumns,"row-key":"id",pagination:{rowsPerPage:20}},{"body-cell-detail":(0,s.k6)((e=>[(0,s.bF)(C,{align:"center"},{default:(0,s.k6)((()=>[(0,s.bF)(g,{flat:"",dense:"",round:"",color:"primary",icon:"sym_r_arrow_outward",onClick:t=>d.redirectToItem(e.row)},null,8,["onClick"])])),_:2},1024)])),_:1},8,["rows","columns"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,s.Lk)("div",i,[(0,s.bF)(D,{users:d.staffUsers,"total-count":d.userCount,onReloadUser:d.getUserData},null,8,["users","total-count","onReloadUser"])])])}var u=a(1271),p=a(2261),_=a(555),b=a(455);const g={name:"ViewDashboard",components:{UserManagement:(0,s.$V)((()=>Promise.all([a.e(121),a.e(633)]).then(a.bind(a,1633))))},setup(){const e=(0,b.rd)(),t=(0,_.KR)([]),a=(0,_.KR)(0),l=(0,_.KR)([]),o=(0,_.KR)([]),n=(0,_.KR)(!1),c={class:"bg-blue text-white shadow-4",offset:[10,10],contentStyle:"font-size: 12px"},r=e=>{const t={"truckdispatch.status_in_transit":"orange","truckdispatch.status_completed":"green","truckdispatch.status_cancelled":"red","truckdispatch.status_pending":"red"};return t[e]||"grey-8"},i=[{name:"action_time",label:"Time",field:"action_time",align:"left",sortable:!0},{name:"content_type",label:"Type",field:"content_type",align:"left",sortable:!0},{name:"object_id",label:"Object ID",field:"object_id",align:"left",sortable:!0},{name:"action",label:"Action",field:"action_type",align:"left",sortable:!0},{name:"user",label:"User",field:"user",align:"left"}],d=[...i,{name:"detail",label:"Go To",field:"detail",align:"center"}],g=t=>{const a=t.content_type.charAt(0).toUpperCase()+t.content_type.slice(1)+"List",s=t.content_type.charAt(0).toUpperCase()+t.content_type.slice(1);e.push({name:a,params:{id:t.object_id}}),u.A.set("pending_link_change",s)},m=()=>{e.push({name:"TruckDispatchList"}),u.A.set("pending_link_change","TruckDispatch")},k=async()=>{const[e,t]=await Promise.all([(0,p.getauth)("dashboard/actions"),(0,p.getauth)("truckdispatch")]);await h(),o.value=t.results||[],l.value=e.results||[]},h=async()=>{const e=await(0,p.getauth)("dashboard/userlist");t.value=e.results||[],a.value=e.count||t.value.length},f=()=>{const e=u.A.getItem("userRole");console.log(e),console.log(e)};return(0,s.sV)((()=>{f(),k()})),{staffUsers:t,userCount:a,getStatusColor:r,recentActions:l,transports:o,expandActionDialog:n,redirectToItem:g,openTruckDispatchPage:m,columns:i,dialogColumns:d,tooltip:c,getUserData:h}}};var m=a(2807),k=a(3316),h=a(4189),f=a(492),A=a(6384),F=a(7410),q=a(386),y=a(3999),v=a(124),w=a(5173),C=a(3954),x=a(6653),D=a(2156),Q=a(8670),T=a(3676),U=a(5262),R=a(8582),L=a.n(R);const I=(0,m.A)(g,[["render",d]]),P=I;L()(g,"components",{QCard:k.A,QCardSection:h.A,QIcon:f.A,QBtn:A.A,QTooltip:F.A,QSeparator:q.A,QList:y.A,QItem:v.A,QItemSection:w.A,QBadge:C.A,QTable:x.A,QDialog:D.A,QBar:Q.A,QSpace:T.A,QTd:U.A})}}]);